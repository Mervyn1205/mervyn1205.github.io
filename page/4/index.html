<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Coding Change Our Life">
<meta property="og:type" content="website">
<meta property="og:title" content="Mervyn&#39;s Blog">
<meta property="og:url" content="https://www.mervyntang.com/page/4/index.html">
<meta property="og:site_name" content="Mervyn&#39;s Blog">
<meta property="og:description" content="Coding Change Our Life">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mervyn&#39;s Blog">
<meta name="twitter:description" content="Coding Change Our Life">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.mervyntang.com/page/4/">





  <title>Mervyn's Blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?05d754b9fcfd6144ad1210688d2c72d8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mervyn's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/75.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/75.html" itemprop="url">Go 调试利器 delve 使用</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-14T20:11:00+08:00">
                2018-07-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go-调试利器-delve-使用"><a href="#Go-调试利器-delve-使用" class="headerlink" title="Go 调试利器 delve 使用"></a>Go 调试利器 delve 使用</h1><p><a href="https://github.com/derekparker/delve" rel="external nofollow noopener noreferrer" target="_blank">Delve</a> 是一个专门为调试 go 程序而生的调试工具，它比 GDB 更强大，尤其时调试多 goroutine 高并发的 go 程序。</p>
<h2 id="安装-Delve"><a href="#安装-Delve" class="headerlink" title="安装 Delve"></a>安装 Delve</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u github.com/derekparker/delve/cmd/dlv</span><br></pre></td></tr></table></figure>
<h2 id="断点调试"><a href="#断点调试" class="headerlink" title="断点调试"></a>断点调试</h2><h3 id="启动调试"><a href="#启动调试" class="headerlink" title="启动调试"></a>启动调试</h3><p>Devle 是一个非常棒的 go 调试工具，支持多种调试方式，直接运行调试，或者 attach 到一个正在运行中的 go 程序，进行调试。</p>
<ul>
<li>直接调试<br>通过 <code>dlv debug</code> 命令进入调试环境</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  demo dlv debug demo.go</span><br><span class="line">Type 'help' for list of commands.</span><br><span class="line">(dlv)</span><br></pre></td></tr></table></figure>
<ul>
<li>通过 <code>attach</code> 调试<br>例：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">go build main.go</span><br><span class="line">./main</span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过 ps 命令查看对应程序的 pid</span></span><br><span class="line">ps aux|grep main</span><br><span class="line"></span><br><span class="line">dlv attach 29260</span><br></pre></td></tr></table></figure>
<h3 id="可用的调试命令"><a href="#可用的调试命令" class="headerlink" title="可用的调试命令"></a>可用的调试命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">➜  demo dlv debug demo.go</span><br><span class="line">Type &apos;help&apos; for list of commands.</span><br><span class="line">(dlv) help</span><br><span class="line">The following commands are available:</span><br><span class="line">    args ------------------------ Print function arguments.</span><br><span class="line">    break (alias: b) ------------ Sets a breakpoint.</span><br><span class="line">    breakpoints (alias: bp) ----- Print out info for active breakpoints.</span><br><span class="line">    call ------------------------ Resumes process, injecting a function call (EXPERIMENTAL!!!)</span><br><span class="line">    clear ----------------------- Deletes breakpoint.</span><br><span class="line">    clearall -------------------- Deletes multiple breakpoints.</span><br><span class="line">    condition (alias: cond) ----- Set breakpoint condition.</span><br><span class="line">    config ---------------------- Changes configuration parameters.</span><br><span class="line">    continue (alias: c) --------- Run until breakpoint or program termination.</span><br><span class="line">    disassemble (alias: disass) - Disassembler.</span><br><span class="line">    down ------------------------ Move the current frame down.</span><br><span class="line">    exit (alias: quit | q) ------ Exit the debugger.</span><br><span class="line">    frame ----------------------- Set the current frame, or execute command on a different frame.</span><br><span class="line">    funcs ----------------------- Print list of functions.</span><br><span class="line">    goroutine ------------------- Shows or changes current goroutine</span><br><span class="line">    goroutines ------------------ List program goroutines.</span><br><span class="line">    help (alias: h) ------------- Prints the help message.</span><br><span class="line">    list (alias: ls | l) -------- Show source code.</span><br><span class="line">    locals ---------------------- Print local variables.</span><br><span class="line">    next (alias: n) ------------- Step over to next source line.</span><br><span class="line">    on -------------------------- Executes a command when a breakpoint is hit.</span><br><span class="line">    print (alias: p) ------------ Evaluate an expression.</span><br><span class="line">    regs ------------------------ Print contents of CPU registers.</span><br><span class="line">    restart (alias: r) ---------- Restart process.</span><br><span class="line">    set ------------------------- Changes the value of a variable.</span><br><span class="line">    source ---------------------- Executes a file containing a list of delve commands</span><br><span class="line">    sources --------------------- Print list of source files.</span><br><span class="line">    stack (alias: bt) ----------- Print stack trace.</span><br><span class="line">    step (alias: s) ------------- Single step through program.</span><br><span class="line">    step-instruction (alias: si)  Single step a single cpu instruction.</span><br><span class="line">    stepout --------------------- Step out of the current function.</span><br><span class="line">    thread (alias: tr) ---------- Switch to the specified thread.</span><br><span class="line">    threads --------------------- Print out info for every traced thread.</span><br><span class="line">    trace (alias: t) ------------ Set tracepoint.</span><br><span class="line">    types ----------------------- Print list of types</span><br><span class="line">    up -------------------------- Move the current frame up.</span><br><span class="line">    vars ------------------------ Print package variables.</span><br><span class="line">    whatis ---------------------- Prints type of an expression.</span><br><span class="line">Type help followed by a command for full documentation.</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/73.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/73.html" itemprop="url">Go语言学习（七）| 包</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-03T20:11:00+08:00">
                2018-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（七）-包"><a href="#Go语言学习（七）-包" class="headerlink" title="Go语言学习（七）| 包"></a>Go语言学习（七）| 包</h1><h2 id="包的定义"><a href="#包的定义" class="headerlink" title="包的定义"></a>包的定义</h2><p>包是函数和数据的集合。<br>用 <code>package</code> 保留字定义一个包。例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br></pre></td></tr></table></figure></p>
<p>文件名不需要与包名一致。包名的约定是使用小写字符。<br>Go 包可以由多个文件组成，但是使用相同的 <code>package &lt;name&gt;</code> 这一行。</p>
<p>包的函数命名方式：</p>
<ul>
<li>公有函数的名字以大写字母开头；</li>
<li>私有函数的名字以小写字幕开头。</li>
</ul>
<p>标识符如果已小写字母开头，则对包外是不可见的，但是他们在整个包的内部是可见并且可用的</p>
<h2 id="main包"><a href="#main包" class="headerlink" title="main包"></a>main包</h2><p><code>package main</code> 表示一个可独立执行的程序。<br>每个 Go 应用程序都包含一个名为 <code>main</code> 的包。</p>
<h2 id="包中的-init-函数"><a href="#包中的-init-函数" class="headerlink" title="包中的 init 函数"></a>包中的 init 函数</h2><p><code>init</code> 函数是包的一个特殊的函数，每个含有该函数的包都会首先执行这个包。</p>
<p>init 调用顺序</p>
<ol>
<li>对同一个 go 文件的 <code>init()</code> 调用顺序是从上到下的</li>
<li>对同一个 <code>package</code> 中不同文件是按文件名字符串比较 “从小到大” 顺序调用各文件中的 <code>init()</code> 函数</li>
<li>对于对不同的 <code>package</code> ，如果不相互依赖的话，按照 <code>main</code> 包中 <code>**先import的后调用**</code> 的顺序调用其包中的 <code>init()</code></li>
<li>如果 <code>package</code> 存在依赖，则先调用最早被依赖的 <code>package</code> 中的 <code>init()</code> ,然后调用 <code>main</code> 函数</li>
</ol>
<h2 id="导入包"><a href="#导入包" class="headerlink" title="导入包"></a>导入包</h2><p>包的导入通过使用 <code>import</code> 来实现。import 导入包有如下几种操作方式</p>
<h3 id="相对路径导入"><a href="#相对路径导入" class="headerlink" title="相对路径导入"></a>相对路径导入</h3><pre><code>例：
</code></pre><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./model"</span> <span class="comment">//当前文件同一目录的model目录，但是不建议这种方式来 import</span></span><br></pre></td></tr></table></figure>
<h3 id="绝对路径导入"><a href="#绝对路径导入" class="headerlink" title="绝对路径导入"></a>绝对路径导入</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"shorturl/model"</span> <span class="comment">//加载gopath/src/shorturl/model模块</span></span><br></pre></td></tr></table></figure>
<h3 id="点操作"><a href="#点操作" class="headerlink" title="点操作"></a>点操作</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> . <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    dd := <span class="number">101</span></span><br><span class="line">    Printf(<span class="string">"%d"</span>, dd) <span class="comment">//因为上面用的点操作导入的包，所以现在就不需要前面加包名，即 fmt.Printf()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="别名操作"><a href="#别名操作" class="headerlink" title="别名操作"></a>别名操作</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> f <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    dd := <span class="number">101</span></span><br><span class="line">    f.Printf(<span class="string">"%d"</span>, dd) <span class="comment">//因为上面将fmt包起了个别名f，用fmt.Printf()就会报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="操作"><a href="#操作" class="headerlink" title="_ 操作"></a><code>_</code> 操作</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"database/sql"</span></span><br><span class="line">    _ <span class="string">"github.com/ziutek/mymysql/godrv"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><code>_</code> 操作其实是引入该包，而不直接使用包里面的函数，而是调用了该包里面的 <code>init</code> 函数</p>
<h2 id="自定义包"><a href="#自定义包" class="headerlink" title="自定义包"></a>自定义包</h2><p>以定义一个even包为例：</p>
<h3 id="自定义包-（以-even-包为例）"><a href="#自定义包-（以-even-包为例）" class="headerlink" title="自定义包 （以 even 包为例）"></a>自定义包 （以 even 包为例）</h3><p>文件： even.go<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> even <span class="comment">//开始自定义的包</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Even</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123; <span class="comment">// 可导出函数（函数名首字母大写）</span></span><br><span class="line">    <span class="keyword">return</span> i%<span class="number">2</span> == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">odd</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123; <span class="comment">// 私有函数（函数名首字母小写）</span></span><br><span class="line">    <span class="keyword">return</span> i%<span class="number">2</span> == <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">vi .bashrc //在最后加入 export GOPATH=$HOME/go 保存退出 GOPATH 的路径可自己定义</span><br><span class="line">source .bashrc     //使刚配置的GOPATH生效</span><br><span class="line">mkdir -p $GOPATH/src/even</span><br></pre></td></tr></table></figure>
<p>将上述的 even.go 文件放入 <code>$GOPATH/src/even</code></p>
<p><strong>注意</strong>：<br>文件夹 even 的名字要和 even.go 文件中 <code>package &lt;name&gt;</code> 中 name 的名字相同。 even.go 文件名可以随意</p>
<h3 id="使用定义的-even-包"><a href="#使用定义的-even-包" class="headerlink" title="使用定义的 even 包"></a>使用定义的 even 包</h3><p>文件： myeven.go<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"even"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    i := <span class="number">5</span></span><br><span class="line">    fmt.Printf(<span class="string">"Is %d even? %v\n"</span>, i, even.Even(i))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br>Is 5 even? false</p>
<h3 id="包测试"><a href="#包测试" class="headerlink" title="包测试"></a>包测试</h3><p>在包放置的目录下（如 <code>$GOPATH/src/even</code> ）建立一个 <code>*_test.go</code> 文件<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Fail</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></p>
<p>Fail 标记测试函数失败，但仍然继续执行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">FailNow</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>FailNow 标记测试函数失败，并且中断其执行。这将会执行下一个测试。因此，当前文件的其他所有测试都被跳过。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Log</span><span class="params">(args ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>
<p>Log 用默认格式对其参数进行格式化，与Print() 类似，并且记录文本到错误日志。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Fatal</span><span class="params">(args ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>
<p>Fatal 等价于Log() 后跟随FailNow()。</p>
<p>将这些凑到一起，就可以编写测试了。首先，选择名字even_test.go。然后添加下面的内容：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> even</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestEven</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> !Even(<span class="number">2</span>) &#123;</span><br><span class="line">        t.Log(<span class="string">"2 should be even!"</span>)</span><br><span class="line">        t.Fail()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意在第一行使用了 package even，测试使用与被测试的包使用相同的名字空间<br>在包目录中执行 go test 即可</p>
<p>ok even 0.001s</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/71.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/71.html" itemprop="url">Go语言学习（六）| 函数</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-01T22:12:00+08:00">
                2018-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（六）-函数"><a href="#Go语言学习（六）-函数" class="headerlink" title="Go语言学习（六）| 函数"></a>Go语言学习（六）| 函数</h1><h2 id="函数的定义"><a href="#函数的定义" class="headerlink" title="函数的定义"></a>函数的定义</h2><p>关键字 <code>func</code> 用来声明一个函数<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">functionName</span><span class="params">(parameter <span class="keyword">type</span>)</span> <span class="title">returnType</span></span> &#123;</span><br><span class="line">    <span class="comment">// 函数体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>函数中的参数列表和返回值并非是必须的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">functionName</span><span class="params">(parameter <span class="keyword">type</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 函数体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果有连续若干个参数，它们的类型一致，那么我们无须一一罗列，只需在最后一个参数后添加该类型。例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calc</span><span class="params">(num, price <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> price * num</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>多返回值</strong></p>
<p>Go 语言支持一个函数可以有多个返回值括号，同时可以命名返回值。一旦命名了返回值，可以认为这些值在函数第一行就被声明为变量了。<br>如果有连续若干个返回值，它们的类型一致，那么我们无须一一罗列，只需在最后一个返回值后添加该类型。</p>
<p>例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    s := Factorial(4)</span><br><span class="line">    println(s)</span><br><span class="line">&#125;</span><br><span class="line">func Factorial(x int) int &#123;</span><br><span class="line">    var result int</span><br><span class="line">    if x == 0 &#123;</span><br><span class="line">        result = 1</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        result = x * Factorial(x-1)</span><br><span class="line">    &#125;</span><br><span class="line">    return result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>也可以上述例子改为：<br>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := Factorial(<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">println</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Factorial</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="params">(result <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span> &#123;</span><br><span class="line">        result = <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result = x * Factorial(x<span class="number">-1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官方建议：最好命名返回值，因为不命名返回值，虽然代码更加简洁了，但是会造成生成的文档可读性差。</span><br></pre></td></tr></table></figure>
<h2 id="保留函数"><a href="#保留函数" class="headerlink" title="保留函数"></a>保留函数</h2><ul>
<li><code>init</code> 函数（能够应用于所有的package）</li>
<li><code>main</code> 函数（只能应用于package main）。</li>
</ul>
<p>这两个函数在定义时不能有任何的参数和返回值。Go程序会自动调用 <code>init()</code> 和 <code>main()</code> ，所以你不需要在任何地方调用这两个函数。<br>每个 package 中的 <code>init</code> 函数都是可选的，但 <code>package main</code> 就必须包含一个main函数。</p>
<h2 id="变参"><a href="#变参" class="headerlink" title="变参"></a>变参</h2><p>接受变参的函数是有着不定数量的参数的。为了做到这点，首先需要定义函数使其接受变参：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">funcName</span><span class="params">(arg ...<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>arg ... int</code> 告诉 Go 这个函数接受不定数量的参数。</p>
<p><strong>注意</strong> 这些参数的类型全部是 int。在函数体中，变量 arg 是一个 int 类型的 slice</p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    test(<span class="string">"a"</span>, <span class="string">"b"</span>)</span><br><span class="line">    test(<span class="string">"Hello"</span>, <span class="string">"world"</span>, <span class="string">"你好"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(arg ...<span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, val := <span class="keyword">range</span> arg &#123;</span><br><span class="line">        fmt.Printf(<span class="string">"%s\n"</span>, val)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="函数作为值"><a href="#函数作为值" class="headerlink" title="函数作为值"></a>函数作为值</h2><p>上例也可以这样：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    demo := <span class="function"><span class="keyword">func</span><span class="params">(arg ...<span class="keyword">string</span>)</span></span> &#123; <span class="comment">//定义一个匿名函数，并且赋值给demo</span></span><br><span class="line">        <span class="keyword">for</span> _, val := <span class="keyword">range</span> arg &#123;</span><br><span class="line">            fmt.Printf(<span class="string">"%s\n"</span>, val)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    demo(<span class="string">"a"</span>, <span class="string">"b"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>函数作为值也可以用在其他地方，如 <code>map</code> 。<br>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    map1 := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">int</span></span>&#123;</span><br><span class="line">        <span class="number">1</span>: <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; <span class="keyword">return</span> x + <span class="number">1</span> &#125;,</span><br><span class="line">        <span class="number">2</span>: <span class="function"><span class="keyword">func</span><span class="params">(y <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; <span class="keyword">return</span> y + <span class="number">2</span> &#125;,</span><br><span class="line">        <span class="number">3</span>: <span class="function"><span class="keyword">func</span><span class="params">(z <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; <span class="keyword">return</span> z + <span class="number">3</span> &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, map1[<span class="number">1</span>](<span class="number">1</span>))</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, map1[<span class="number">2</span>](<span class="number">1</span>))</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, map1[<span class="number">3</span>](<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    callback(<span class="number">2</span>, printit)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printit</span><span class="params">(x <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">callback</span><span class="params">(y <span class="keyword">int</span>, f <span class="keyword">func</span>(<span class="keyword">int</span>)</span>)</span> &#123;</span><br><span class="line">    f(y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：2</p>
<p>例2：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    callback(<span class="number">2</span>, printit)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printit</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="params">(demo <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    demo = x + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">callback</span><span class="params">(y <span class="keyword">int</span>, f <span class="keyword">func</span>(<span class="keyword">int</span>)</span> <span class="title">int</span>)</span> &#123;</span><br><span class="line">    result := f(y)</span><br><span class="line">    res := fmt.Sprintf(<span class="string">"%d"</span>, result) + <span class="string">"demo"</span> <span class="comment">// Sprintf()将int转换成string</span></span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br>3demo</p>
<h2 id="传值和传指针"><a href="#传值和传指针" class="headerlink" title="传值和传指针"></a>传值和传指针</h2><p>例3：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//简单的一个函数，实现了参数+1的操作</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add1</span><span class="params">(a *<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; <span class="comment">// 请注意，</span></span><br><span class="line">    *a = *a + <span class="number">1</span> <span class="comment">// 修改了a的值</span></span><br><span class="line">    <span class="keyword">return</span> *a   <span class="comment">// 返回新值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    x := <span class="number">3</span></span><br><span class="line">    fmt.Println(<span class="string">"x = "</span>, x)    <span class="comment">// 应该输出 "x = 3"</span></span><br><span class="line">    x1 := add1(&amp;x)            <span class="comment">// 调用 add1(&amp;x) 传x的地址</span></span><br><span class="line">    fmt.Println(<span class="string">"x+1 = "</span>, x1) <span class="comment">// 应该输出 "x+1 = 4"</span></span><br><span class="line">    fmt.Println(<span class="string">"x = "</span>, x)    <span class="comment">// 应该输出 "x = 4"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>变量在内存中是存放于一定地址上的，修改变量实际是修改变量地址处的内存。只有 add1 函数知道 x 变量所在的地址，才能修改 x 变量的值。所以我们需要将x所在地址 <code>&amp;x</code> 传入函数，并将函数的参数的类型由int改为 <code>*int</code> ，即改为指针类型，才能在函数中修改 x 变量的值。此时参数仍然是按 copy 传递的，只是 copy 的是一个指针。</p>
<p>函数传递指针的好处：</p>
<ul>
<li>传指针使得多个函数能操作同一个对象。</li>
<li>传指针比较轻量级 (8bytes),只是传内存地址，我们可以用指针传递体积大的结构体。如果用参数值传递的话, 在每次 copy 上面就会花费相对较多的系统开销（内存和时间）。所以当你要传递大的结构体的时候，用指针是一个明智的选择。</li>
</ul>
<p>Go语言中 <code>string</code> ， <code>slice</code> ， <code>map</code> 这三种类型的实现机制类似指针，所以可以直接传递，而不用取地址后传递指针。（注：若函数需改变 <code>slice</code> 的长度，则仍需要取地址传递指针）</p>
<h2 id="延迟代码-defer"><a href="#延迟代码-defer" class="headerlink" title="延迟代码 defer"></a>延迟代码 defer</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReadWrite</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    file.Open(<span class="string">"file"</span>)</span><br><span class="line">    <span class="comment">// 做一些工作</span></span><br><span class="line">    <span class="keyword">if</span> failureX &#123;</span><br><span class="line">        file.Close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> failureY &#123;</span><br><span class="line">        file.Close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    file.Close()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里有许多重复的代码。为了解决这些，Go 有了 defer 语句。在 <code>defer</code> 后指定的函数会在函数退出前调用。可改为如下代码：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReadWrite</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    file.Open(<span class="string">"file"</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close() <span class="comment">//file.Close() 被添加到了 defer 列表</span></span><br><span class="line">    <span class="comment">// 做一些工作</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> failureX &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// Close() 现在自动调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> failureY &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 这里Close() 也将自动调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>defer</code> 有点类似于 PHP 类中的 <code>__destruct()</code> 析构方法。  <code>defer</code> 也可以这样写：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>如果有很多调用 defer ，那么 defer 是采用后进先出模式<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">5</span>; j++ &#123;</span><br><span class="line">        <span class="keyword">defer</span> <span class="built_in">println</span>(j)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出:<br>4<br>3<br>2<br>1<br>0</p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := test(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">println</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="params">(t <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        t++</span><br><span class="line">    &#125;()</span><br><span class="line">    t = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：4</p>
<p>例2：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := test(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">println</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="params">(t <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">        t += x</span><br><span class="line">    &#125;(<span class="number">5</span>)</span><br><span class="line">    t = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：8</p>
<p>在 Go 中函数也是一种变量，可以通过 <code>type</code> 来定义它，它的类型就是所有拥有相同的参数，相同的返回值的一种类型</p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> testInt <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">bool</span> //声明了一个函数类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    slice := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">"slice = "</span>, slice)</span><br><span class="line">    odd := filter(slice, isOdd) <span class="comment">//函数当做值来传递了</span></span><br><span class="line">    fmt.Println(<span class="string">"Odd elements of slice are: "</span>, odd)</span><br><span class="line">    even := filter(slice, isEven) <span class="comment">//函数当做值来传递了</span></span><br><span class="line">    fmt.Println(<span class="string">"Even elements of slice are: "</span>, even)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isOdd</span><span class="params">(integer <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> integer%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isEven</span><span class="params">(integer <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> integer%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明的函数在这个地方当做了一个参数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">filter</span><span class="params">(slice []<span class="keyword">int</span>, f testInt)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result []<span class="keyword">int</span></span><br><span class="line">    <span class="keyword">for</span> _, value := <span class="keyword">range</span> slice &#123;</span><br><span class="line">        <span class="keyword">if</span> f(value) &#123;</span><br><span class="line">            result = <span class="built_in">append</span>(result, value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>返回结果：<br>slice = [1 2 3 4 5 7]<br>Odd elements of slice are: [1 3 5 7]<br>Even elements of slice are: [2 4]</p>
<h2 id="Panic和Recover"><a href="#Panic和Recover" class="headerlink" title="Panic和Recover"></a>Panic和Recover</h2><h3 id="panic"><a href="#panic" class="headerlink" title="panic"></a>panic</h3><p><code>panic</code> 是用来表示非常严重的不可恢复的错误的。<br>在 Go 语言中这是一个内置函数，接收一个 <code>interface{}</code> 类型的值（也就是任何值了）作为参数。<br><code>panic</code> 的作用就像我们平常接触的异常。不过Go可没有 try…catch ，所以， <code>panic</code> 一般会导致程序挂掉（除非 <code>recover</code> ）。所以，Go语言中的异常，那真的是异常了。<br>但是，关键的一点是，即使函数执行的时候panic了，函数不往下走了，运行时并不是立刻向上传递 <code>panic</code> ，而是到defer那，等defer的东西都跑完了， <code>panic</code> 再向上传递。所以这时候 defer 有点类似 try-catch-finally 中的 finally。</p>
<h3 id="recover"><a href="#recover" class="headerlink" title="recover"></a>recover</h3><p>Go语言提供了 <code>recover</code> 内置函数，前面提到，一旦 <code>panic</code> ，逻辑就会走到 <code>defer</code> 那，那我们就在 <code>defer</code> 那等着，调用 <code>recover</code> 函数将会捕获到当前的 <code>panic</code> （如果有的话），被捕获到的 <code>panic</code> 就不会向上传递了，于是，世界恢复了和平。你可以干你想干的事情了。</p>
<p>不过要注意的是， <code>recover</code> 之后，逻辑并不会恢复到 <code>panic</code> 那个点去，函数还是会在 <code>defer</code> 之后返回。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/69.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/69.html" itemprop="url">Go语言学习（五）| 控制结构</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-01T21:12:00+08:00">
                2018-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（五）-控制结构"><a href="#Go语言学习（五）-控制结构" class="headerlink" title="Go语言学习（五）| 控制结构"></a>Go语言学习（五）| 控制结构</h1><p>Go 对于值之间的比较有非常严格的限制，只有两个类型相同的值才可以进行比较，如果值的类型是接口，它们也必须都实现了相同的接口</p>
<p>for循环(没有do或者while)<br>switch和if<br>select 类型选择和多路通讯转接器</p>
<h2 id="条件控制"><a href="#条件控制" class="headerlink" title="条件控制"></a>条件控制</h2><h3 id="if-else-if"><a href="#if-else-if" class="headerlink" title="if / else if"></a>if / else if</h3><p>Go 的 if 还有个强大的地方就是条件判断语句里面允许声明一个变量，这个变量的作用域只能在该条件逻辑块内，其他地方就不起作用了，如下所示：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算获取值x,然后根据x返回的大小，判断是否大于10。</span></span><br><span class="line"><span class="keyword">if</span> x := computedValue(); x &gt; <span class="number">10</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"x is greater than 10"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"x is less than 10"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个地方如果这样调用就编译出错了，因为 x 是条件里面的变量</span></span><br><span class="line">fmt.Println(x)</span><br></pre></td></tr></table></figure></p>
<p>使用 <code>else if</code> 时必须要注意中间的空格</p>
<h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    i := <span class="number">1</span></span><br><span class="line">    <span class="keyword">switch</span> i &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">println</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">fallthrough</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">println</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">println</span>(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong></p>
<p>默认每个 <code>case</code> 后都带有 <code>break</code>，匹配成功后不会自动向下执行其他 case 。<br><code>fallthrough</code> 关键字用来强制执行下一个 case 的值，如果 <code>fallthrough</code> 关键字后面显式的写 <code>break</code> 关键字会报错</p>
<p>例2：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    i := <span class="number">1</span></span><br><span class="line">    <span class="keyword">switch</span> i &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>, <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">println</span>(i)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">println</span>(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="goto"><a href="#goto" class="headerlink" title="goto"></a>goto</h3><p>用 goto 跳转到一定是当前函数内定义的标签。标签名大小写敏感。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    demo()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">demo</span><span class="params">()</span></span> &#123;</span><br><span class="line">    i := <span class="number">0</span></span><br><span class="line">Here:</span><br><span class="line">    fmt.Println(i)</span><br><span class="line">    i++</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">5</span> &#123;</span><br><span class="line">        <span class="keyword">goto</span> Here</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>循环语句是用来重复执行某一段代码。</p>
<h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><p>for的三种形式</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//与 PHP 的 for 一样</span></span><br><span class="line"><span class="keyword">for</span> init; condition; post &#123;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//和 while 一样</span></span><br><span class="line"><span class="keyword">for</span> condition &#123;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//和 PHP 的 while(true) 一样(死循环)</span></span><br><span class="line"><span class="keyword">for</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p><code>continue</code> 语句用来跳出 for 循环中当前循环。<br>在 continue 语句后的所有的 for 循环语句都不会在本次循环中执行。循环体会在一下次循环中继续执行。<br>嵌套循环时，可以再 <code>break</code> 后面指定标签。用标签决定那个循环被终止。但是如果标签定义了就一定要使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">J:</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">5</span>; j++ &#123;</span><br><span class="line">        <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">5</span> &#123;</span><br><span class="line">                <span class="keyword">break</span> J <span class="comment">//直接退出最外层循环J</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">println</span>(i)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="range-循环"><a href="#range-循环" class="headerlink" title="range 循环"></a>range 循环</h3><p>range 可用于 <code>slice</code> 、 <code>array</code> 、 <code>string</code>、 <code>map</code> 和 <code>channel</code> 。<br>当对 <code>slice</code> 或者 <code>array</code> 做循环时， <code>range</code> 返回序号作为键，这个序号对应的内容作为值。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    str := <span class="string">"I love 中国"</span></span><br><span class="line">    <span class="keyword">for</span> k, v := <span class="keyword">range</span> str &#123;</span><br><span class="line">        fmt.Printf(<span class="string">"%d %s\n"</span>, k, v)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例2：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := [...]<span class="keyword">string</span>&#123;<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> _, val := <span class="keyword">range</span> arr &#123; <span class="comment">//这个如果下面不想用到数组的序号，则要用 '_'</span></span><br><span class="line">        fmt.Printf(<span class="string">"%s"</span>, val)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">"\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>也可以在字符串上直接使用 range 。</p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    list := []<span class="keyword">string</span>&#123;<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> k, v := <span class="keyword">range</span> list &#123;</span><br><span class="line">        fmt.Printf(<span class="string">"%d %s\n"</span>, k, v)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"-----------------"</span>)</span><br><span class="line"></span><br><span class="line">    list1 := <span class="string">"e例f"</span></span><br><span class="line">    <span class="keyword">for</span> pos, char := <span class="keyword">range</span> list1 &#123;</span><br><span class="line">        fmt.Printf(<span class="string">"%d %c\n"</span>, pos, char)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0 a</span><br><span class="line">1 b</span><br><span class="line">2 c</span><br><span class="line">3 d</span><br><span class="line">-----------------</span><br><span class="line">0 e</span><br><span class="line">1 例      //注意：“例” 这个字占了3个字节，所以下面的序号变为了4</span><br><span class="line">4 f</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/67.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/67.html" itemprop="url">Go语言学习（四）| 数组、切片、集合</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-30T19:22:00+08:00">
                2018-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（四）-数组、切片、集合"><a href="#Go语言学习（四）-数组、切片、集合" class="headerlink" title="Go语言学习（四）| 数组、切片、集合"></a>Go语言学习（四）| 数组、切片、集合</h1><h2 id="array"><a href="#array" class="headerlink" title="array"></a>array</h2><h3 id="声明数组"><a href="#声明数组" class="headerlink" title="声明数组"></a>声明数组</h3><p>array由 <code>[n]&lt;type&gt;</code> 定义，n为array的长度，<type>标示希望存储的内容的类型。例：</type></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr [<span class="number">10</span>]<span class="keyword">int</span>     <span class="comment">//声明一个int类型的数组</span></span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">42</span>         <span class="comment">//数组下标是从0开始的</span></span><br><span class="line">arr[<span class="number">1</span>] = <span class="number">13</span>         <span class="comment">//赋值操作</span></span><br></pre></td></tr></table></figure>
<p>数组的索引从 0 开始到 length - 1 结束。数组中的所有元素都被自动赋值为数组类型的零值。</p>
<p><strong>NOTE</strong> 数组的大小是类型的一部分.</p>
<p>由于长度也是数组类型的一部分，因此 [3]int 与 [4]int 是不同的类型，数组也就不能改变长度。</p>
<p>Go 中的数组是值类型而不是引用类型。</p>
<p>数组之间的赋值是值的赋值，即当把一个数组作为参数传入函数的时候，传入的其实是该数组的副本，而不是它的指针。<br>如果要使用指针，那么就需要用到后面介绍的 <code>slice</code> 类型了。</p>
<h3 id="初始化数组"><a href="#初始化数组" class="headerlink" title="初始化数组"></a>初始化数组</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>
<p>初始化数组中 {} 中的元素个数不能大于 [] 中的数字。<br>如果忽略 [] 中的数字不设置数组大小，Go 语言会根据元素的个数来设置数组的大小：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>初始化数组时，可以只初始化部分数组的值，例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b := [<span class="number">10</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; <span class="comment">//声明了一个长度为10的int数组，其中前3个元素初始化为1、2、3，其他默认为0。</span></span><br></pre></td></tr></table></figure></p>
<h3 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a := [<span class="number">2</span>][<span class="number">2</span>]<span class="keyword">int</span>&#123; [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;, [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">3</span>, <span class="number">4</span>&#125; &#125;</span><br><span class="line">    fmt.Println(a)</span><br><span class="line"></span><br><span class="line">    b := [<span class="number">2</span>][<span class="number">3</span>] <span class="keyword">int</span> &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>&#125;&#125;</span><br><span class="line">    fmt.Println(b)  <span class="comment">//[[1 2 3] [2 2 3]]</span></span><br><span class="line"></span><br><span class="line">    c := [<span class="number">2</span>][<span class="number">2</span>]<span class="keyword">int</span>&#123;[...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;, [...]<span class="keyword">int</span>&#123;<span class="number">3</span>, <span class="number">4</span>&#125; &#125;</span><br><span class="line">    fmt.Println(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h2><p>slice 与 array 接近，但是在新的元素加入的时候可以增加长度.slice 是一个指向 array 的指针，这是其与 array 不同的地方；<br>slice 是引用类型，这意味着当赋值某个 slice 到另外一个变量，两个引用会指向同一个 array.</p>
<h3 id="创建切片"><a href="#创建切片" class="headerlink" title="创建切片"></a>创建切片</h3><h4 id="基于数组创建"><a href="#基于数组创建" class="headerlink" title="基于数组创建"></a>基于数组创建</h4><p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//定义一个 5 个元素的 array，序号从 0 到 4</span></span><br><span class="line">    a := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">"array a is:"</span>, a)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从序号 2 至 3 创建 slice，它包含元素 3, 4 , s1 := a[0:6]; 编译时会报错。因为超出了数组范围</span></span><br><span class="line">    s1 := a[<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line">    fmt.Println(<span class="string">"slice s1 is:"</span>, s1)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从序号 1 至 4 创建，它包含元素 2, 3, 4, 5</span></span><br><span class="line">    s2 := a[<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line">    fmt.Println(<span class="string">"slice s2 is:"</span>, s2)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用 array 中的所有元素创建 slice，这是 a[0:len(a)] 的简化写法</span></span><br><span class="line">    s3 := a[:]</span><br><span class="line">    fmt.Println(<span class="string">"slice s3 is:"</span>, s3)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从序号 0 至 3 创建，这是 a[0:4] 的简化写法，得到 1, 2, 3, 4</span></span><br><span class="line">    s4 := a[:<span class="number">4</span>]</span><br><span class="line">    fmt.Println(<span class="string">"slice s4 is:"</span>, s4)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从 slice s2 创建 slice，注意 s5 仍然指向 array a。a的值变了，slice的值也随之改变</span></span><br><span class="line">    s5 := s2[:]</span><br><span class="line">    fmt.Println(<span class="string">"slice s5 is:"</span>, s5)</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"-----------------"</span>)</span><br><span class="line">    s2[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    fmt.Println(<span class="string">"array a is:"</span>, a)</span><br><span class="line">    fmt.Println(<span class="string">"slice s1 is:"</span>, s1)</span><br><span class="line">    fmt.Println(<span class="string">"slice s2 is:"</span>, s2)</span><br><span class="line">    fmt.Println(<span class="string">"slice s3 is:"</span>, s3)</span><br><span class="line">    fmt.Println(<span class="string">"slice s4 is:"</span>, s4)</span><br><span class="line">    fmt.Println(<span class="string">"slice s5 is:"</span>, s5)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述执行输出结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">array a is: [1 2 3 4 5]</span><br><span class="line">slice s1 is: [3 4]</span><br><span class="line">slice s2 is: [2 3 4 5]</span><br><span class="line">slice s3 is: [1 2 3 4 5]</span><br><span class="line">slice s4 is: [1 2 3 4]</span><br><span class="line">slice s5 is: [2 3 4 5]</span><br><span class="line">-----------------</span><br><span class="line">array a is: [1 1 3 4 5]</span><br><span class="line">slice s1 is: [3 4]</span><br><span class="line">slice s2 is: [1 3 4 5]</span><br><span class="line">slice s3 is: [1 1 3 4 5]</span><br><span class="line">slice s4 is: [1 1 3 4]</span><br><span class="line">slice s5 is: [1 3 4 5]</span><br></pre></td></tr></table></figure></p>
<h4 id="直接创建"><a href="#直接创建" class="headerlink" title="直接创建"></a>直接创建</h4><ul>
<li>创建一个初始元素个数为5的数组切片，元素初始值为0：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mySlice1 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>创建一个初始元素个数为5的数组切片，元素初始值为0，并预留10个元素的存储空间：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mySlice2 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">5</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>直接创建并初始化包含5个元素的数组切片：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mySlice3 := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="slice-和-array-在声明时的区别"><a href="#slice-和-array-在声明时的区别" class="headerlink" title="slice 和 array 在声明时的区别"></a>slice 和 array 在声明时的区别</h3><ul>
<li>声明数组时，方括号内写明了数组的长度或使用 <code>...</code> 自动计算长度</li>
<li>声明 slice 时，方括号内没有任何字符。</li>
<li>slice 可以从一个数组或一个已经存在的 slice 中再次声明。slice 通过array[i:j]来获取，其中 i 是数组的开始位置，j 是结束位置，但不包含 array[j] ,它的长度是 j - i .</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个含有10个元素元素类型为byte的数组</span></span><br><span class="line"><span class="keyword">var</span> ar = [<span class="number">10</span>]<span class="keyword">byte</span> &#123;<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明两个含有byte的slice</span></span><br><span class="line"><span class="keyword">var</span> a, b []<span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a指向数组的第3个元素开始，并到第五个元素结束，</span></span><br><span class="line">a = ar[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment">//现在a含有的元素: ar[2]、ar[3]和ar[4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// b是数组ar的另一个slice</span></span><br><span class="line">b = ar[<span class="number">3</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment">// b的元素是：ar[3]和ar[4]</span></span><br></pre></td></tr></table></figure>
<h3 id="slice的一些简便操作"><a href="#slice的一些简便操作" class="headerlink" title="slice的一些简便操作"></a>slice的一些简便操作</h3><ul>
<li>slice 的默认开始位置是 0，ar[:n] 等价于 ar[0:n]</li>
<li>slice 的第二个序列默认是数组的长度，ar[n:] 等价于 ar[n:len(ar)]</li>
<li>如果从一个数组里面直接获取 slice，可以这样 ar[:]，因为默认第一个序列是 0，第二个是数组的长度，即等价于 ar[0:len(ar)]</li>
</ul>
<h3 id="操作-slice-几个有用的内置函数"><a href="#操作-slice-几个有用的内置函数" class="headerlink" title="操作 slice 几个有用的内置函数"></a>操作 slice 几个有用的内置函数</h3><ul>
<li><code>len</code> 获取 slice 的长度。</li>
<li><code>cap</code> 获取slice的最大容量。</li>
<li><code>append</code> 向 slice 里面追加一个或者多个元素，然后返回一个和 slice 一样类型的 slice。</li>
<li><code>copy</code> 函数 copy 从源 slice 的 src 中复制元素到目标 dst，并且返回复制的元素的个数。</li>
</ul>
<p>函数 <code>copy</code> 从源 slice src 复制元素到目标 dst，并且返回复制的元素的个数。源和目标可能重叠。复制的数量是 len(src) 和 len(dst) 中的最小值。</p>
<p><strong>注</strong><br>append 函数会改变 slice 所引用的数组的内容，从而影响到引用同一数组的其它 slice。 但当 slice 中没有剩余空间（即(cap - len) == 0）时，此时将动态分配新的数组空间。返回的 slice 数组指针将指向这个空间，而原数组的内容将保持不变；其它引用此数组的 slice 则不受影响。</p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    arr := [<span class="number">10</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    s1 := arr[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    fmt.Println(<span class="built_in">len</span>(s1))    <span class="comment">//输出2</span></span><br><span class="line">    fmt.Println(<span class="built_in">cap</span>(s1))    <span class="comment">//输出10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><h3 id="声明-map"><a href="#声明-map" class="headerlink" title="声明 map"></a>声明 map</h3><p>一般定义 map 的方法是：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">map</span>[&lt;from <span class="keyword">type</span>&gt;] &lt;to <span class="keyword">type</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers <span class="keyword">map</span>[<span class="keyword">string</span>] <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">numbers := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>] <span class="keyword">int</span>)</span><br></pre></td></tr></table></figure></p>
<p>当只需要声明一个 map 的时候，使用 make 的形式：monthdays := make(map[string]int)<br>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    monthdays := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;</span><br><span class="line">        <span class="string">"Jan"</span>: <span class="number">31</span>, <span class="string">"Feb"</span>: <span class="number">28</span>, <span class="string">"Mar"</span>: <span class="number">31</span>,</span><br><span class="line">        <span class="string">"Apr"</span>: <span class="number">30</span>, <span class="string">"May"</span>: <span class="number">31</span>, <span class="string">"Jun"</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="string">"Jul"</span>: <span class="number">31</span>, <span class="string">"Aug"</span>: <span class="number">31</span>, <span class="string">"Sep"</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="string">"Oct"</span>: <span class="number">31</span>, <span class="string">"Nov"</span>: <span class="number">30</span>, <span class="string">"Dec"</span>: <span class="number">31</span>,<span class="comment">//此处的逗号是必须的</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key, val := <span class="keyword">range</span> monthdays &#123;</span><br><span class="line">        fmt.Printf(<span class="string">"key = %s, val = %d\n"</span>, key, val)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当在 map 中索引（搜索）时，使用方括号。<br>例如打印出 12 月的天数：fmt.Printf(“%d\n”, monthdays[“Dec”])<br>这个map就像我们平常看到的表格一样，左边列是 key ，右边列是值</p>
<p>使用map过程中需要注意的几点：</p>
<ul>
<li>map 是无序的，所以上述例子每次打印出来的结果顺序都不一样都会不一样，它不能通过 index 获取，而必须通过 key 获取</li>
<li>map 的长度是不固定的，也就是和 slice 一样，也是一种引用类型</li>
<li>内置的 len 函数同样适用于 map，返回 map 拥有的 key 的数量</li>
<li>map 的值可以很方便的修改，通过 monthdays[“Feb”] = 20 可以很容易的把 key 为 Feb 的字典值改为 20</li>
<li>map 和其他基本类别不同，它不是 <code>Thread-safe</code> ，在多个 goroutine 存取时，必须使用 mutex lock 机制。 Go1.9 以后可用 <code>sync.Map</code> 解决这个问题</li>
<li>map 的初始化可以通过 <code>key:val</code> 的方式初始化值，同时 map 内置有判断是否存在 key 的方式</li>
</ul>
<h3 id="通过-delete-删除-map-的元素"><a href="#通过-delete-删除-map-的元素" class="headerlink" title="通过 delete 删除 map 的元素"></a>通过 delete 删除 map 的元素</h3><p>例：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    monthdays := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;</span><br><span class="line">        <span class="string">"Jan"</span>: <span class="number">31</span>, <span class="string">"Feb"</span>: <span class="number">28</span>, <span class="string">"Mar"</span>: <span class="number">31</span>,</span><br><span class="line">        <span class="string">"Apr"</span>: <span class="number">30</span>, <span class="string">"May"</span>: <span class="number">31</span>, <span class="string">"Jun"</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="string">"Jul"</span>: <span class="number">31</span>, <span class="string">"Aug"</span>: <span class="number">31</span>, <span class="string">"Sep"</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="string">"Oct"</span>: <span class="number">31</span>, <span class="string">"Nov"</span>: <span class="number">30</span>, <span class="string">"Dec"</span>: <span class="number">31</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除map中Feb元素</span></span><br><span class="line">    <span class="built_in">delete</span>(monthdays, <span class="string">"Feb"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//map 有两个返回值，第一个返回值为该 key 的值;</span></span><br><span class="line">    <span class="comment">// 第二个返回值，如果不存在 key，那么 ok 为 false，如果存在 ok 为 true</span></span><br><span class="line">    val, ok := monthdays[<span class="string">"Feb"</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断monthdays["Feb"]是否存在</span></span><br><span class="line">    <span class="keyword">if</span> ok &#123;</span><br><span class="line">        <span class="built_in">println</span>(<span class="string">"Feb is in the map and its value is"</span>, val)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println</span>(<span class="string">"Feb isn't in the map"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br>Feb isn’t in the map</p>
<p>例2：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Vertex <span class="keyword">struct</span> &#123;</span><br><span class="line">    Lat, Long <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ms = <span class="keyword">map</span>[<span class="keyword">string</span>]Vertex&#123;</span><br><span class="line">    <span class="string">"Bell Labs"</span>: &#123;<span class="number">40.68433</span>, <span class="number">-74.39967</span>&#125;,</span><br><span class="line">    <span class="string">"Google"</span>:    &#123;<span class="number">37.42202</span>, <span class="number">-122.08408</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(ms)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>map 也是一种引用类型，如果两个 map 同时指向一个底层，那么一个改变，另一个也相应的改变：</p>
<p>例<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">    fmt.Println(<span class="string">"map m is: "</span>, m)</span><br><span class="line"></span><br><span class="line">    m[<span class="string">"Hello"</span>] = <span class="string">"Bonjour"</span></span><br><span class="line">    m[<span class="string">"World"</span>] = <span class="string">"XXXXX"</span></span><br><span class="line">    fmt.Println(<span class="string">"map m is: "</span>, m)</span><br><span class="line"></span><br><span class="line">    m1 := m</span><br><span class="line">    fmt.Println(<span class="string">"map m1 is: "</span>, m1)</span><br><span class="line"></span><br><span class="line">    m1[<span class="string">"Hello"</span>] = <span class="string">"Salut"</span>  <span class="comment">// 现在m["hello"]的值已经是Salut了</span></span><br><span class="line">    fmt.Println(<span class="string">"map m is: "</span>, m)</span><br><span class="line">    fmt.Println(<span class="string">"map m1 is: "</span>, m1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/65.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/65.html" itemprop="url">Go语言学习（三）| 基础数据类型</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-26T20:22:00+08:00">
                2018-06-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（三）-基础数据类型"><a href="#Go语言学习（三）-基础数据类型" class="headerlink" title="Go语言学习（三）| 基础数据类型"></a>Go语言学习（三）| 基础数据类型</h1><p>Go 基础数据类型:</p>
<ul>
<li>布尔型</li>
<li>数字类型</li>
<li>字符串类型</li>
<li>错误类型</li>
</ul>
<h2 id="布尔型-bool"><a href="#布尔型-bool" class="headerlink" title="布尔型 bool"></a>布尔型 bool</h2><p>布尔型的值只能为 <code>true</code> 或 <code>false</code> , 例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v1 <span class="keyword">bool</span> = <span class="literal">true</span></span><br><span class="line">v1 := (<span class="number">2</span> &gt; <span class="number">1</span>)   <span class="comment">//这种方式会自动推导为 bool 类型</span></span><br></pre></td></tr></table></figure>
<p>布尔可以做3种逻辑运算，<code>&amp;&amp;</code> <code>||</code> <code>!</code></p>
<p>支持的比较操作符：<code>&lt;</code> <code>&gt;</code> <code>==</code> <code>!=</code> <code>&lt;=</code> <code>&gt;=</code></p>
<p><strong>NOTE</strong> 布尔类型不能接受其他类型的赋值，不支持自动或强制的类型转换。</p>
<h2 id="数字类型"><a href="#数字类型" class="headerlink" title="数字类型"></a>数字类型</h2><h3 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h3><p>整型类型主要为：</p>
<ul>
<li><code>int8</code>  有符号 8 位整型 ( -128 到 127 )</li>
<li><code>uint8</code> 无符号 8 位整型 ( 0 到 255 )</li>
<li><code>byte</code> 类似 <code>uint8</code> 但不属于同一个类型</li>
<li><code>int16</code></li>
<li><code>uint16</code></li>
<li><code>uint32</code> 无符号 32 位整型</li>
<li><code>uint64</code>无符号 64 位整型</li>
<li><code>int32</code></li>
<li><code>rune</code> 类似 <code>int32</code> 用UTF-8编码。例如循环字符串获取实际字符时就需要使用 <code>rune</code> 类型</li>
<li><code>int64</code></li>
<li><code>uint</code> 32 或 64 位,由硬件决定最大长度</li>
<li><code>int</code> 32 或 64 位,由硬件决定最大长度</li>
<li><code>uintptr</code> 无符号整型，用于存放一个指针</li>
</ul>
<p>Go语言支持以下的常规整数运算：<code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>%</code> 。 其中 <code>%</code> 是求余运算。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> % <span class="number">3</span> <span class="comment">//结果为：2</span></span><br></pre></td></tr></table></figure>
<h3 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h3><h4 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h4><ul>
<li><code>float32</code> 32位浮点数，精确到小数点后7位</li>
<li><code>float64</code> 64位浮点数，精确到小数点后15位</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v1 <span class="keyword">float32</span> <span class="comment">//声明后默认为 0</span></span><br><span class="line">v2 := <span class="number">12.0</span> <span class="comment">//如果不加小数点，v2 会被推导为整型而不是浮点型</span></span><br></pre></td></tr></table></figure>
<p>浮点数不能直接用 <code>==</code> 来判断两个浮点数是否相等。下面是一种推荐的替代方案：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"math"</span></span><br><span class="line"><span class="keyword">const</span> MIN = <span class="number">0.000001</span></span><br><span class="line"><span class="comment">// MIN 为用户自定义的比较精度</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">IsEqual</span><span class="params">(f1, f2 <span class="keyword">float64</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> math.Dim(f1, f2) &lt; MIN</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="复数"><a href="#复数" class="headerlink" title="复数"></a>复数</h4><ul>
<li><code>complex64</code> 32 位实数和虚数</li>
<li><code>complex128</code> 64 位实数和虚数</li>
</ul>
<p>下边为声明 <code>complex64</code> 变量的例子：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> v1 <span class="keyword">complex64</span> <span class="comment">//声明后默认为(0+0i)</span></span><br><span class="line">    v1 = <span class="number">3.2</span> + <span class="number">12i</span></span><br><span class="line">    v2 := <span class="number">3.2</span> + <span class="number">12i</span></span><br><span class="line">    v3 := <span class="built_in">complex</span>(<span class="number">3.2</span>, <span class="number">12</span>)</span><br><span class="line">    fmt.Println(v1, v2, v3)<span class="comment">//输出结果为：(3.2+12i) (3.2+12i) (3.2+12i)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h2><p>字符串在Go中是 <code>UTF-8</code> 的由双引号(<code>&quot;</code>)或反引号(``)包裹的字符序列(类型为string)。如果使用单引号则表示一个字符（UTF-8编码）<br>一旦给变量赋值，字符串就不能修改了。如果想要修改可使用如下方式:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := <span class="string">"Hello, world!"</span></span><br><span class="line">    c := []<span class="keyword">byte</span>(s) <span class="comment">//将字符串转换为[]byte类型</span></span><br><span class="line">    c[<span class="number">0</span>] = <span class="string">'c'</span></span><br><span class="line">    s2 := <span class="keyword">string</span>(c) <span class="comment">//再转换为string</span></span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, s2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者使用另外一种方式：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := <span class="string">"hello, world!"</span></span><br><span class="line">    fmt.Printf(<span class="string">"%c\n"</span>, s[<span class="number">0</span>]) <span class="comment">//输出h，注意输出时的格式为c</span></span><br><span class="line">    s = <span class="string">"c"</span> + s[<span class="number">1</span>:]          <span class="comment">// 字符串虽不能更改，但可进行切片操作</span></span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, s)    <span class="comment">//输出结果：cello, world!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>连接两个字符串</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    str := <span class="string">"Starting part "</span> +</span><br><span class="line">    <span class="string">"Ending part"</span></span><br><span class="line">    fmt.Println(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>NOTE</strong> 在循环中使用加号 <code>+</code> 拼接字符串并不是最高效的做法，更好的办法是使用函数 <code>strings.Join()</code> ，使用字节缓冲（ <code>bytes.Buffer</code> ）拼接更加给力！</p>
<h3 id="字符类型-rune"><a href="#字符类型-rune" class="headerlink" title="字符类型 rune"></a>字符类型 rune</h3><p>在Go语言中支持两个字符类型，要给是byte（实际上是uint8的别名），代表UTF-8字符串的单个字节的值；另一个是rune,代表单个Unicode字符。<br>关于rune相关操作，可查阅Go标准库的unicode包。另外unicode/utf8包也提供了UTF-8和Unicode之间的转换。</p>
<h3 id="字符串遍历"><a href="#字符串遍历" class="headerlink" title="字符串遍历"></a>字符串遍历</h3><p>Go语言支持两种方式遍历字符串。</p>
<ul>
<li>以字节数组的方式遍历</li>
<li>以Unicode字符遍历</li>
</ul>
<p>例:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    str := <span class="string">"Hello, 你好, 世界"</span></span><br><span class="line">    length := <span class="built_in">len</span>(str)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以字节数组的方式遍历</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; length; i++ &#123;</span><br><span class="line">        ch := str[i]</span><br><span class="line">        fmt.Println(i, ch)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以Unicode字符遍历</span></span><br><span class="line">    <span class="keyword">for</span> i,ch := <span class="keyword">range</span> str &#123;</span><br><span class="line">        fmt.Println(i,ch)<span class="comment">//ch的类型为rune</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>NOTE</strong> 以Unicode字符方式遍历时，每个字符的类型是rune,而不是byte。</p>
<h2 id="错误类型-error"><a href="#错误类型-error" class="headerlink" title="错误类型 error"></a>错误类型 error</h2><p>error类型本身就是一个预定义好的接口，里面定义了一个method。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type error interface &#123;</span><br><span class="line">    Error() string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成一个新的error并返回，一般有以下几种处理方式：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"errors"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> CustomError <span class="keyword">struct</span> &#123;</span><br><span class="line">    infoa <span class="keyword">string</span></span><br><span class="line">    infob <span class="keyword">string</span></span><br><span class="line">    Err   error <span class="comment">//声明后默认为nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cerr CustomError)</span> <span class="title">Error</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    errorinfo := fmt.Sprintf(<span class="string">"infoa : %s , infob : %s , original err info : %s "</span>, cerr.infoa, cerr.infob, cerr.Err.Error())</span><br><span class="line">    <span class="keyword">return</span> errorinfo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//方法一：采用errors包的New方法 返回一个err的类型</span></span><br><span class="line">    <span class="keyword">var</span> err error</span><br><span class="line">    err = errors.New(<span class="string">"this is a new error"</span>)</span><br><span class="line">    <span class="comment">//由于已经实现了error接口的方法 因此可以直接调用对应的方法</span></span><br><span class="line">    fmt.Println(err.Error())    <span class="comment">//输出结果：error new</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法二： 采用fmt.Errorf 将string信息转化为error信息 并返回</span></span><br><span class="line">    err = fmt.Errorf(<span class="string">"%s"</span>, <span class="string">"the error test for fmt.Errorf"</span>)</span><br><span class="line">    fmt.Println(err.Error())    <span class="comment">//输出结果：fmt.Errorf</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法三： 采用自定义的方式实现一个error的 一个duck 类型</span></span><br><span class="line">    err = &amp;CustomError&#123;</span><br><span class="line">        infoa: <span class="string">"err info a"</span>,</span><br><span class="line">        infob: <span class="string">"err info b"</span>,</span><br><span class="line">        Err:   errors.New(<span class="string">"test custom err"</span>),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出结果：infoa : err info a , infob : err info b , original err info : custom err</span></span><br><span class="line">    fmt.Println(err.Error())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/63.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/63.html" itemprop="url">Go语言学习（二）| 变量</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-24T20:50:00+08:00">
                2018-06-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（二）-变量"><a href="#Go语言学习（二）-变量" class="headerlink" title="Go语言学习（二）| 变量"></a>Go语言学习（二）| 变量</h1><p>Go变量的类型在变量名的后面。</p>
<h3 id="声明单个变量"><a href="#声明单个变量" class="headerlink" title="声明单个变量"></a>声明单个变量</h3><p>使用语法为： <code>var var_name type</code> , 例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> age <span class="keyword">int</span> = <span class="number">10</span>    <span class="comment">//声明单个变量并初始化</span></span><br></pre></td></tr></table></figure>
<h3 id="声明多个变量"><a href="#声明多个变量" class="headerlink" title="声明多个变量"></a>声明多个变量</h3><p>使用语法为： <code>var var_name1, var_name2 type</code> , 例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> width, height <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> width, height <span class="keyword">int</span> = <span class="number">100</span>, <span class="number">50</span> <span class="comment">// 声明多个变量</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    name <span class="keyword">string</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h3><p>如果变量有初始值，那么 Go 能够自动推断具有初始值的变量的类型。如果变量有初始值，就可以在变量声明中省略 <code>type</code> 。例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span>    <span class="comment">//自动推到为 int 类型</span></span><br></pre></td></tr></table></figure>
<h3 id="简短声明"><a href="#简短声明" class="headerlink" title="简短声明"></a>简短声明</h3><p>语法： <code>var_name := value</code></p>
<p><strong>NOTE</strong> 简短声明要求 <strong>:=</strong> 操作符左边的所有变量都有初始值且只能用于方法内部, 声明并初始化新的变量,不能用于已声明变量赋值。</p>
<p><code>:=</code> 操作左边必须要有新变量,多个变量初始化只需要满足左边至少有一个新变量即可</p>
<h3 id="特殊变量"><a href="#特殊变量" class="headerlink" title="特殊变量"></a>特殊变量</h3><p>特殊变量名 <code>_</code>(下划线)。任何赋值给它的值都会给舍弃。例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_, b := <span class="number">34</span>, <span class="number">35</span>  <span class="comment">//将35赋值给b，同时丢弃34</span></span><br></pre></td></tr></table></figure>
<p><strong>Note</strong> Go编译器对声明却未使用的变量会报错。但是全局变量时允许声明但不使用的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/60.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/60.html" itemprop="url">Go语言学习（一）| 环境搭建</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-18T21:30:00+08:00">
                2018-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Go语言学习（一）-环境搭建"><a href="#Go语言学习（一）-环境搭建" class="headerlink" title="Go语言学习（一）| 环境搭建"></a>Go语言学习（一）| 环境搭建</h1><h2 id="Linux-下安装"><a href="#Linux-下安装" class="headerlink" title="Linux 下安装"></a>Linux 下安装</h2><ol>
<li><p>已1.10.3 为例，下载源码包：<a href="https://golang.org/dl" rel="external nofollow noopener noreferrer" target="_blank">下载地址</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>将下载的源码包解压至 /usr/local目录。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -C /usr/local -xzvf go1.10.3.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 <code>/usr/local/go/bin</code> 加入 <code>PHTH</code> 环境变量。可以将下边的内容加入 <code>/etc/profile</code> 或 <code>$HOME/.profile</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/go/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>加入上述内容后可以手动执行命令 <code>source /etc/profile</code> （假设你将上述命令加入到了 <code>/etc/profile</code> 文件中） 使其实时生效</p>
</li>
<li><p>压缩包也可以解压到其他文件夹，但是如果解压到了其他文件夹必须要设置 <code>$GOROOT</code> , 如果将 go 安装到了自己的家目录，加入到 profile 文件的内容应该为如下内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GOROOT=$HOME/go1.X</span><br><span class="line">export PATH=$PATH:$GOROOT/bin</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>NOTE:  GOROOT 只有在定义安装目录才必须要进行设置</p>
<h2 id="相关环境变量及设置"><a href="#相关环境变量及设置" class="headerlink" title="相关环境变量及设置"></a>相关环境变量及设置</h2><h3 id="GOROOT"><a href="#GOROOT" class="headerlink" title="GOROOT"></a>GOROOT</h3><p>GO语言安装的路径</p>
<h3 id="GOPATH"><a href="#GOPATH" class="headerlink" title="GOPATH"></a>GOPATH</h3><p>表示代码包所在的地址，可以设置多个。</p>
<h4 id="Go源码加载顺序"><a href="#Go源码加载顺序" class="headerlink" title="Go源码加载顺序"></a>Go源码加载顺序</h4><p>GOPATH &gt; GOROOT</p>
<p>假设：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GOPATH=~/gopath1:~/gopath2</span><br><span class="line"></span><br><span class="line">GOROOT=/usr/local/go</span><br></pre></td></tr></table></figure>
<p>当我们在代码中引用了包：<code>github.com/xxx</code> 时</p>
<p>那么：GO程序在编译时会按先后次序到以下目录中寻找源码：</p>
<p>~/gopath1/src/github.com/xxx<br>~/gopath2/scr/github.com/xxx<br>/usr/local/go/src/github.com/xxx</p>
<p>如果三个目录中都没有找到这个包，就会报错。</p>
<p>要加载的包的源代码必须放在 <code>GOPATH</code> 路径下的 <code>src</code> 目录，否则还是提示加载不到包</p>
<h4 id="Go项目目录结构"><a href="#Go项目目录结构" class="headerlink" title="Go项目目录结构"></a>Go项目目录结构</h4><p>当 GOPATH=~/workspace/go 时<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@mervyn:~/workspace# tree</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">└── go</span><br><span class="line">    ├── bin</span><br><span class="line">    │   └── project1</span><br><span class="line">    ├── pkg</span><br><span class="line">    └── src</span><br><span class="line">        └── project1</span><br><span class="line">            ├── controllers</span><br><span class="line">            └── main.go</span><br></pre></td></tr></table></figure></p>
<p>其中</p>
<ul>
<li>bin 目录为 go 编译可执行文件存放的的路径</li>
<li>pkg 目录为 go 编译包时，生成的 <code>.a</code> 文件存放路径</li>
<li>src 目录为源码路径。</li>
</ul>
<h3 id="GOBIN"><a href="#GOBIN" class="headerlink" title="GOBIN"></a>GOBIN</h3><p>存放执行 <code>go install</code> 命令后生成的二级制文件</p>
<p>go install 会生成可执行文件直接放到 <code>GOBIN</code> 目录下，当然这是有前提的<br>你编译的是可执行文件，如果是一个普通的包，会被编译生成到pkg目录下该文件是.a结尾</p>
<p>到此已完成Go 环境的的搭建工作，选择一个IDE即可可以开始进行项目开发了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/58.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/58.html" itemprop="url">PHPStorm 解决单例模式下无法进行代码提示问题</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-15T20:30:00+08:00">
                2018-06-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index">
                    <span itemprop="name">Tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在我们写代码时，为了防止一个类被重复实例化，往往采用 <em>单例模式</em> 实例化类。<br>通常的做法是先写好一个基类 BaseLogic.class.php，内容如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Logic</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseLogic</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $instance = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $class_name = get_called_class();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">self</span>::$instance[$class_name])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>::$instance[$class_name];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>::$instance[$class_name] = <span class="keyword">new</span> <span class="keyword">static</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$instance[$class_name];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>实际写业务逻辑时需要继承上边的 <code>BaseLogic</code> , 代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Logic</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderLogic</span> <span class="keyword">extends</span> <span class="title">BaseLogic</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrderInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"order info"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>实际使用该 <code>OrderLogic</code> 时，使用以下方法即可：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OrderLogic::getInstance()-&gt;getOrderInfo();</span><br></pre></td></tr></table></figure></p>
<p>当用这种方式写代码时， PHPStorm 无法识别 <code>getOrderInfo</code> 方法, 针对这种情况只需要在函数上方加入注释 <code>@return static</code> 即可， 修改后的代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Logic</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseLogic</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $instance = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> static</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $class_name = get_called_class();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">self</span>::$instance[$class_name])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>::$instance[$class_name];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>::$instance[$class_name] = <span class="keyword">new</span> <span class="keyword">static</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$instance[$class_name];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrderInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"get Order Info"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderLogic</span> <span class="keyword">extends</span> <span class="title">BaseLogic</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrderInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"order info"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">OrderLogic::getInstance()-&gt;getOrderInfo();</span><br></pre></td></tr></table></figure></p>
<p>这时如果 <code>BaseLogic</code> 的 <code>getInstance</code> 方法的注释是 <code>@return self</code> 则跳转时只能跳到 <code>BaseLogic</code> 类对应的方法而无法跳到子类中。</p>
<p>这里主要跟 PHP 的后期延伸绑定有关。</p>
<p>参考链接：</p>
<p><a href="http://php.net/manual/zh/language.oop5.late-static-bindings.php" rel="external nofollow noopener noreferrer" target="_blank">后期静态绑定</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mervyntang.com/133.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/133.html" itemprop="url">vim 配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-14T09:16:00+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index">
                    <span itemprop="name">Tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="初始化目录"><a href="#初始化目录" class="headerlink" title="初始化目录"></a>初始化目录</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/.vim/bundle</span><br><span class="line">mkdir -p ~/.vim/colors</span><br><span class="line">mkdir -p ~/.vim/plugin</span><br><span class="line">mkdir -p ~/.vim/doc</span><br></pre></td></tr></table></figure>
<h2 id="安装插件管理器-Vundle"><a href="#安装插件管理器-Vundle" class="headerlink" title="安装插件管理器 Vundle"></a>安装插件管理器 Vundle</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim</span><br></pre></td></tr></table></figure>
<p>如果需要通过 <code>Vundle</code> 管理插件，只需要在 <code>.vimrc</code> 文件配置相应的插件即可。<br><strong>注意</strong> 插件名需要写在 <code>vundle</code> 块中间：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set rtp+=~/.vim/bundle/Vundle.vim</span><br><span class="line">call vundle#begin()</span><br><span class="line">Plugin &apos;Plugin Name&apos;</span><br><span class="line">call vundle#end()            &quot; required</span><br><span class="line">filetype plugin indent on    &quot; required</span><br></pre></td></tr></table></figure></p>
<p>目前本人用到的插件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">set rtp+=~/.vim/bundle/Vundle.vim</span><br><span class="line">call vundle#begin()</span><br><span class="line">Plugin &apos;gmarik/Vundle.vim&apos;</span><br><span class="line">Plugin &apos;scrooloose/nerdtree&apos;</span><br><span class="line">Plugin &apos;shawncplus/phpcomplete.vim&apos;</span><br><span class="line">Plugin &apos;mileszs/ack.vim&apos;</span><br><span class="line">Plugin &apos;tpope/vim-fugitive&apos;</span><br><span class="line">Plugin &apos;kien/ctrlp.vim&apos;</span><br><span class="line">Plugin &apos;stephpy/vim-php-cs-fixer&apos;</span><br><span class="line">call vundle#end()            &quot; required</span><br><span class="line">filetype plugin indent on    &quot; required</span><br></pre></td></tr></table></figure>
<p>保存退出后执行 <code>vim +PluginInstall</code> 即可。</p>
<p><strong>注意</strong><br><code>vim-php-cs-fixer</code> 插件依赖 <code>php-cs-fixer</code> , 如果需要自定义格式化的配置， 在 <code>~/.php_cs.dist</code> 文件中写对应配置即可。</p>
<p><code>Vundle</code> 具体用法可见 <a href="https://github.com/VundleVim/Vundle.vim" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/VundleVim/Vundle.vim</a><br><code>php-cs-fixer</code> 具体用法可见 <a href="https://github.com/FriendsOfPHP/PHP-CS-Fixer" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/FriendsOfPHP/PHP-CS-Fixer</a></p>
<h2 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h2><p>找到一个适合自己的主题，这里我采取的是 <code>monokai</code> 这款主题，样式比较接近 <code>sublime</code>。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul>
<li>下载主题 <a href="https://github.com/sickill/vim-monokai" rel="external nofollow noopener noreferrer" target="_blank">monokai</a></li>
<li>将 <code>monokai.vim</code> 放入 <code>~/.vim/colors</code></li>
</ul>
<h3 id="启用主题"><a href="#启用主题" class="headerlink" title="启用主题"></a>启用主题</h3><p>在 <code>~/.vimrc</code> 文件中加入如下内容即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">colorscheme monokai</span><br></pre></td></tr></table></figure></p>
<h2 id="函数跳转"><a href="#函数跳转" class="headerlink" title="函数跳转"></a>函数跳转</h2><h3 id="安装-ctags"><a href="#安装-ctags" class="headerlink" title="安装 ctags"></a>安装 ctags</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://prdownloads.sourceforge.net/ctags/ctags-5.8.tar.gz</span><br><span class="line">tar xvzf ctags-5.8.tar.gz</span><br><span class="line">cd ctags-5.8/</span><br><span class="line">./configure</span><br><span class="line">sudo make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<h3 id="安装-taglist-插件"><a href="#安装-taglist-插件" class="headerlink" title="安装 taglist 插件"></a>安装 taglist 插件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://nchc.dl.sourceforge.net/project/vim-taglist/vim-taglist/4.6/taglist_46.zip</span><br><span class="line">unzip taglist_46.zip</span><br><span class="line">mv doc/taglist.txt ~/.vim/doc/</span><br><span class="line">mv plugin/taglist.vim ~/.vim/plugin</span><br></pre></td></tr></table></figure>
<p>下边是本人用的 <code>vim</code> 配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">colorscheme monokai</span><br><span class="line">set nocompatible              &quot; required</span><br><span class="line">filetype on                  &quot; required</span><br><span class="line">set number</span><br><span class="line">set tabstop=4       &quot;设置 tab 制表符所占宽度为 4</span><br><span class="line">set softtabstop=4   &quot;设置按 tab 时缩进的宽度为 4</span><br><span class="line">set shiftwidth=4    &quot;设置自动缩进宽度为 4</span><br><span class="line">set expandtab       &quot;缩进时将 tab 制表符转换为空格</span><br><span class="line">set encoding=utf-8</span><br><span class="line">set cursorline</span><br><span class="line"></span><br><span class="line">&quot; set runtimepath^=~/.vim/bundle/ctrlp.vim</span><br><span class="line">set rtp+=~/.vim/bundle/Vundle.vim</span><br><span class="line">call vundle#begin()</span><br><span class="line">Plugin &apos;gmarik/Vundle.vim&apos;</span><br><span class="line">Plugin &apos;scrooloose/nerdtree&apos;</span><br><span class="line">Plugin &apos;shawncplus/phpcomplete.vim&apos;</span><br><span class="line">Plugin &apos;mileszs/ack.vim&apos;</span><br><span class="line">Plugin &apos;tpope/vim-fugitive&apos;</span><br><span class="line">Plugin &apos;kien/ctrlp.vim&apos;</span><br><span class="line">Plugin &apos;stephpy/vim-php-cs-fixer&apos;</span><br><span class="line">call vundle#end()            &quot; required</span><br><span class="line">filetype plugin indent on    &quot; required</span><br><span class="line"></span><br><span class="line">&quot;当NERDTree为剩下的唯一窗口时自动关闭</span><br><span class="line">&quot; autocmd bufenter * if (winnr(&quot;$&quot;) == 1 &amp;&amp; exists(&quot;b:NERDTree&quot;) &amp;&amp; b:NERDTree.isTabTree()) | q | endif</span><br><span class="line">&quot;设置树的显示图标</span><br><span class="line">let g:NERDTreeDirArrowExpandable = &apos;+&apos;</span><br><span class="line">let g:NERDTreeDirArrowCollapsible = &apos;-&apos;</span><br><span class="line">let NERDTreeShowLineNumbers=1</span><br><span class="line">let NERDTreeShowHidden=1</span><br><span class="line">let NERDTreeAutoCenter=1</span><br><span class="line">let NERDTreeIgnore=[&apos;\.pyc&apos;,&apos;\~$&apos;,&apos;\.swp&apos;]</span><br><span class="line">let g:NERDTreeChDirMode       = 2</span><br><span class="line">let g:ctrlp_working_path_mode = &apos;ra&apos;</span><br><span class="line">let g:php_cs_fixer_config_file=&apos;.php_cs.dist&apos;</span><br><span class="line"></span><br><span class="line">let Tlist_Show_One_File=1     &quot;不同时显示多个文件的tag，只显示当前文件的</span><br><span class="line">let Tlist_Exit_OnlyWindow=1   &quot;如果taglist窗口是最后一个窗口，则退出vim</span><br><span class="line">let Tlist_Ctags_Cmd=&quot;/usr/local/bin/ctags&quot;</span><br><span class="line">let Tlist_Inc_Winwidth=0 &quot;配置打开函数列表的时候不改变窗口大小</span><br><span class="line"></span><br><span class="line">augroup PHP</span><br><span class="line">    autocmd!</span><br><span class="line"></span><br><span class="line">    &quot; Check for PHP syntax errors after saving a file</span><br><span class="line">    autocmd BufWritePost &#123;*.php&#125; echom system(&quot;php -l &quot;.expand(&apos;%&apos;))</span><br><span class="line">augroup END</span><br><span class="line"></span><br><span class="line">function! UpdateCtags()</span><br><span class="line">    let curdir=getcwd()</span><br><span class="line">    while !filereadable(&quot;./tags&quot;)</span><br><span class="line">        cd ..</span><br><span class="line">        if getcwd() == &quot;/&quot;</span><br><span class="line">            break</span><br><span class="line">        endif</span><br><span class="line">    endwhile</span><br><span class="line">    if filewritable(&quot;./tags&quot;)</span><br><span class="line">        !ctags -R --fields=+aimlS --languages=php</span><br><span class="line">        TlistUpdate</span><br><span class="line">    endif</span><br><span class="line">    execute &quot;:cd &quot; . curdir</span><br><span class="line">endfunction</span><br><span class="line"></span><br><span class="line">map &lt;C-k&gt;&lt;C-b&gt; :NERDTreeToggle&lt;CR&gt;</span><br><span class="line">map &lt;C-k&gt;&lt;C-j&gt; :NERDTreeCWD&lt;CR&gt;</span><br><span class="line">map &lt;C-o&gt; :TlistToggle&lt;CR&gt;</span><br><span class="line">map &lt;c-h&gt; :Ack&lt;space&gt;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpeg" alt="Mervyn">
            
              <p class="site-author-name" itemprop="name">Mervyn</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">62</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Mervyn1205" target="_blank" title="GitHub" rel="external nofollow noopener noreferrer">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:ttz5127@163.com" target="_blank" title="E-Mail" rel="external nofollow noopener noreferrer">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank" rel="external nofollow noopener noreferrer">
                <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.mervyntang.com" title="Mervyn" target="_blank">Mervyn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mervyn1205.github.io/linux-command" title="Linux 命令查找" target="_blank" rel="external nofollow noopener noreferrer">Linux 命令查找</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mervyn</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io" rel="external nofollow noopener noreferrer">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow noopener noreferrer">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    







  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
