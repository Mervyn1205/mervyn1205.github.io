<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Coding Change Our Life">
<meta property="og:type" content="website">
<meta property="og:title" content="Mervyn&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="Mervyn&#39;s Blog">
<meta property="og:description" content="Coding Change Our Life">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mervyn&#39;s Blog">
<meta name="twitter:description" content="Coding Change Our Life">





  
  
  <link rel="canonical" href="http://yoursite.com/page/5/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Mervyn's Blog</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?05d754b9fcfd6144ad1210688d2c72d8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mervyn's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/48.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/48.html" class="post-title-link" itemprop="url">Elasticsearch 安装部署</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-27 15:00:00" itemprop="dateCreated datePublished" datetime="2018-02-27T15:00:00+08:00">2018-02-27</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NoSQL/" itemprop="url" rel="index"><span itemprop="name">NoSQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Elasticsearch-安装部署"><a href="#Elasticsearch-安装部署" class="headerlink" title="Elasticsearch 安装部署"></a>Elasticsearch 安装部署</h1><h3 id="安装依赖（已安装java8的机器可忽略此步）"><a href="#安装依赖（已安装java8的机器可忽略此步）" class="headerlink" title="安装依赖（已安装java8的机器可忽略此步）"></a>安装依赖（已安装java8的机器可忽略此步）</h3><p>依赖:  java &gt;= 8, Only Oracle’s Java and the OpenJDK are supported. 推荐安装 1.8.0_73 or later</p>
<ol>
<li><a href="https://www.java.com/zh_CN/download/manual.jsp" target="_blank" rel="noopener">https://www.java.com/zh_CN/download/manual.jsp</a>  下载对应系统的java</li>
<li>tar zxvf jre-8u131-linux-x64.tar.gz</li>
<li>将该目录放置到想要安装的目录，然后加入linux环境变量$PATH 中</li>
</ol>
<h3 id="安装、启动es"><a href="#安装、启动es" class="headerlink" title="安装、启动es"></a>安装、启动es</h3><h3 id="单机部署"><a href="#单机部署" class="headerlink" title="单机部署"></a>单机部署</h3><p><a href="https://www.elastic.co/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/downloads/elasticsearch</a> 下载编译好的二进制文件，解压后即可使用</p>
<p>如果系统存在多个java环境，需要在启动先指定JAVA_HOME，然后在进行启动，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/java1.8.0 # 如已设置 JAVA_HOME 可以忽略此步</span><br><span class="line">export ES_HEAP_SIZE=10g  #修改 Elasticsearch 的堆内存</span><br><span class="line">bin/elasticsearch -d # 其中-d  表示 es 已守护进程的方式启动</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &apos;http://localhost:9200/?pretty&apos; #测试es是否启动成功</span><br></pre></td></tr></table></figure>
<h3 id="集群部署-以两台服务器为例"><a href="#集群部署-以两台服务器为例" class="headerlink" title="集群部署,以两台服务器为例"></a>集群部署,以两台服务器为例</h3><p>分别配置<code>elasticsearch.yml</code>文件</p>
<ul>
<li>服务器A  ip:192.168.140.129</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cluster.name：app-demo</span><br><span class="line">node.name: node-1</span><br><span class="line">network.host: 192.168.140.129</span><br><span class="line">discovery.zen.ping.unicast.hosts: [&quot;192.168.140.128&quot;]</span><br></pre></td></tr></table></figure>
<ul>
<li>服务器B  ip:192.168.140.128</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cluster.name：app-demo</span><br><span class="line">node.name: node-2</span><br><span class="line">network.host: 192.168.140.128</span><br><span class="line">discovery.zen.ping.unicast.hosts: [&quot;192.168.140.129&quot;]</span><br></pre></td></tr></table></figure>
<p>分别启动即可</p>
<p><code>curl  -u elastic &#39;192.168.140.129:9200/_cat/nodes?v&#39;  #测试集群状态</code></p>
<p><strong>注意： ES启动时不能以 root 用户启动</strong></p>
<h3 id="动态变更配置"><a href="#动态变更配置" class="headerlink" title="动态变更配置"></a>动态变更配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUT /_cluster/settings</span><br><span class="line">&#123;</span><br><span class="line">    &quot;persistent&quot; : &#123;</span><br><span class="line">        &quot;discovery.zen.minimum_master_nodes&quot; : 2  # 永久设置会在全集群重启时存活下来</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;transient&quot; : &#123;</span><br><span class="line">        &quot;indices.store.throttle.max_bytes_per_sec&quot; : &quot;50mb&quot; #临时设置会在第一次全集群重启后被移除</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ES配置文件"><a href="#ES配置文件" class="headerlink" title="ES配置文件"></a>ES配置文件</h3><p>配置文件默认在 <code>$ES_HOME/config/</code> ，也可以在启动时指定加载对应的配置文件</p>
<p>es包含配置文件 <code>elasticsearch.yml</code> (配置 <code>elasticsearch</code> ) 、<code>log4j2.properties</code>（ es 日志相关配置 ）和 <code>jvm.options</code></p>
<p><strong>elasticsearch.yml</strong></p>
<p>该文件yaml格式支持两种配置格式</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">path:</span></span><br><span class="line"><span class="attr">    data:</span> <span class="string">/var/lib/elasticsearch</span></span><br><span class="line"><span class="attr">    logs:</span> <span class="string">/var/log/elasticsearch</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path.data: /var/lib/elasticsearch</span><br><span class="line">path.logs: /var/log/elasticsearch</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>path.data</code>   <strong>这个强烈建议进行修改</strong></p>
<p>  设置索引数据的存储路径，默认是es根目录下的data文件夹，可以设置多个存储路径，用逗号隔开，例：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.data: /path/to/data1,/path/to/data2</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>path.logs</code>  <strong>这个强烈建议进行修改</strong><br>  设置日志文件的存储路径，默认是es根目录下的logs文件夹</p>
</li>
<li><p><code>path.plugins</code><br>  插件路径</p>
</li>
<li><p><code>cluster.name: elasticsearch</code><br>  配置es的集群名称，默认是elasticsearch，es会自动发现在同一网段下的es，如果在同一网段下有多个集群，就可以用这个属性来区分不同的集群。（<strong>最好</strong> 改成一个适当的名字来描述该集群的作用，同时也能防止同一个网段的其他机器测试时影影响）</p>
</li>
<li><p><code>node.name: node-1</code><br>  节点名，默认为uuid前七位，也可以设置为主机的HOSTNAME  ， 如 <code>node.name: ${HOSTNAME}</code></p>
</li>
<li><p><code>bootstrap.memory_lock: true</code><br>  设置为true来锁住内存。因为当jvm开始swapping时es的效率 会降低，所以要保证它不swap，可以把ES_MIN_MEM和ES_MAX_MEM两个环境变量设置成同一个值，并且保证机器有足够的内存分配给es。</p>
</li>
<li><p><code>network.host: 0.0.0.0</code><br>  绑定本机网络地址，设置了此参数，es假设从开发模式变成成产模式，如果配置了0.0.0.0 最好开启防火墙防止外部ip直接连接</p>
</li>
<li><p><code>discovery.zen.ping.unicast.hostsedit</code></p>
<p>   这个设置把组播的自动发现给关闭了，为了防止其他机器上的节点自动连入</p>
</li>
<li><p><code>discovery.zen.minimum_master_nodes</code><br>  设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1.</p>
<p>  此设置应该始终被配置为 master 候选节点的法定个数（大多数个）。法定个数就是 <code>( master 候选节点个数 / 2) + 1</code> 。 这里有几个例子：</p>
<ul>
<li>如果你有 10 个节点（能保存数据，同时能成为 master），法定数就是 <code>6</code> 。</li>
<li>如果你有 3 个候选 master 节点，和 100 个 data 节点，法定数就是 <code>2</code> ，你只要数数那些可以做 master 的节点数就可以了。</li>
<li>如果你有两个节点，你遇到难题了。法定数当然是 <code>2</code> ，但是这意味着如果有一个节点挂掉，你整个集群就不可用了。 设置成 <code>1</code> 可以保证集群的功能，但是就无法保证集群脑裂了，像这样的情况，你最好至少保证有 3 个节点。</li>
</ul>
</li>
<li><p><code>gateway.recover_after_nodes: 8</code></p>
<p>  这将阻止 Elasticsearch 在存在至少 8 个节点（数据节点或者 master 节点）之前进行数据恢复。 这个值的设定取决于个人喜好：整个集群提供服务之前你希望有多少个节点在线？这种情况下，我们设置为 8，这意味着至少要有 8 个节点，该集群才可用。</p>
</li>
<li><p><code>gateway.recover_after_time: 5m</code></p>
</li>
<li><p><code>gateway.expected_nodes: 10</code></p>
<p>  这意味着 Elasticsearch 会采取如下操作：</p>
<ul>
<li>等待集群至少存在 8 个节点</li>
<li><p>等待 5 分钟，或者10 个节点上线后，才进行数据恢复，这取决于哪个条件先达到。</p>
<p>以上三个设置可以在集群重启的时候避免过多的分片交换。这可能会让数据恢复从数个小时缩短为几秒钟。</p>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/159.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/159.html" class="post-title-link" itemprop="url">PHP使用SPL内置迭代器递归遍历目录</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-26 01:21:00" itemprop="dateCreated datePublished" datetime="2018-02-26T01:21:00+08:00">2018-02-26</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>使用<code>PHP</code> 的 <code>SPL</code> 库的迭代器可以很方便的递归遍历某个目录及其子目录下的文件，代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dir = <span class="string">'~/workspace'</span>;</span><br><span class="line">$files = <span class="keyword">new</span> RecursiveIteratorIterator(<span class="keyword">new</span> RecursiveDirectoryIterator($dir));</span><br><span class="line"><span class="keyword">foreach</span> ( $files <span class="keyword">as</span> $file ) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $file-&gt;__toString().<span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考：<br><a href="http://php.net/manual/en/spl.iterators.php" target="_blank" rel="noopener">http://php.net/manual/en/spl.iterators.php</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/56.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/56.html" class="post-title-link" itemprop="url">开发一个本地 composer 包</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-23 15:27:00" itemprop="dateCreated datePublished" datetime="2018-02-23T15:27:00+08:00">2018-02-23</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当我们用版本控制系统（如 git 、github 等）去开发一个 <code>composer</code> 包时是比较好的一种方式，但是当我们项目启动刚开始的时候，需要频繁地进行提交、更新操作。如何在没有 github 、git 、svn 之类的环境下如何开发一个自己的 composer 包就是我们接下来要讲解的内容了。</p>
<h2 id="创建目录、composer初始化"><a href="#创建目录、composer初始化" class="headerlink" title="创建目录、composer初始化"></a>创建目录、composer初始化</h2><p>首先为我们的要开发的composer包初始化一个目录,如下操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/workspace/www</span><br><span class="line">mkdir DateHelper</span><br><span class="line">composer init</span><br></pre></td></tr></table></figure>
<p>然后按照composer的提示填写对应composer包的内容即可，执行完后生成的 <code>composer.json</code> 内容类似如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"mervyn1205/date-helper"</span>,</span><br><span class="line">    <span class="attr">"description"</span>:<span class="string">"a light date helper for php"</span>,</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"library"</span>,</span><br><span class="line">    <span class="attr">"license"</span>: <span class="string">"MIT"</span>,</span><br><span class="line">    <span class="attr">"minimum-stability"</span>: <span class="string">"dev"</span>,</span><br><span class="line">    <span class="attr">"authors"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Mervyn"</span>,</span><br><span class="line">            <span class="attr">"email"</span>: <span class="string">"404245127@qq.com"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"require"</span>: &#123;</span><br><span class="line">        <span class="attr">"php"</span>: <span class="string">"&gt;=5.4.0"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"autoload"</span>: &#123;</span><br><span class="line">        <span class="attr">"psr-4"</span>: &#123;</span><br><span class="line">            <span class="attr">"DateHelper\\"</span>: <span class="string">"src\\"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="开发该composer"><a href="#开发该composer" class="headerlink" title="开发该composer"></a>开发该composer</h2><p>DateHelper目录结构如下：</p>
<blockquote>
<p>  ├── composer.json<br>  ├── LICENSE<br>  ├── README.md<br>  ├── src<br>  │   └── DateHelper.php<br>  └── tests</p>
</blockquote>
<p>其中 <code>src</code> 目录就是 <code>composer</code> 包实际代码放置的目录了。</p>
<p>这里需要注意的是 composer 包对应的命名空间。</p>
<h2 id="本地使用composer包"><a href="#本地使用composer包" class="headerlink" title="本地使用composer包"></a>本地使用composer包</h2><p>进入需要应用该 composer 包的项目目录，引用该composer包即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /www/web/project</span><br><span class="line">touch composer.json</span><br></pre></td></tr></table></figure>
<p>composer.json 内容如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"require-dev"</span>: &#123;</span><br><span class="line">        <span class="attr">"mervyn1205/date-helper"</span>: <span class="string">"@dev"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"repositories"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"path"</span>,</span><br><span class="line">            <span class="attr">"url"</span>: <span class="string">"~/workspace/www/DateHelper"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行<code>composer install</code> 然后加载composer的autoload文件即可。</p>
<p>如果你的composer包已经开发完毕，可以提交到 <a href="https://packagist.org" target="_blank" rel="noopener">https://packagist.org</a> ，这样别人就可以直接通过 composer require 的方式引用你开发的 composer 包了。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/83.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/83.html" class="post-title-link" itemprop="url">阿里云 ssh 免密码登录</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-12-10 15:44:00" itemprop="dateCreated datePublished" datetime="2017-12-10T15:44:00+08:00">2017-12-10</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="配置ssh-key-登录"><a href="#配置ssh-key-登录" class="headerlink" title="配置ssh key 登录"></a>配置ssh key 登录</h2><ol>
<li><p>生成公钥和私钥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C "Mervyn"</span><br></pre></td></tr></table></figure>
</li>
<li><p>将公钥上传至服务器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp id_rsa.pub username@server:~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
</li>
<li><p>登录到服务器（此时需要输入密码)并创建相应的目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh username@server</span><br><span class="line">mkdir ~/.ssh</span><br><span class="line">chmod 700 ~/.ssh</span><br><span class="line">touch ~/.ssh/authorized_keys</span><br><span class="line">chmod 644 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
</li>
<li><p>将公钥加入服务器认证</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br><span class="line">cat id_rsa.pub &gt;&gt; authorized_keys</span><br><span class="line">rm id_rsa.pub</span><br></pre></td></tr></table></figure>
</li>
<li><p>退出再次登录即可无密码登录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh username@server</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="禁止root用户通过密码登录并修改ssh登录端口"><a href="#禁止root用户通过密码登录并修改ssh登录端口" class="headerlink" title="禁止root用户通过密码登录并修改ssh登录端口"></a>禁止root用户通过密码登录并修改ssh登录端口</h2><ol>
<li>修改配置文件 <code>vi /etc/ssh/sshd_config</code></li>
</ol>
<ul>
<li>修改 <code>PermitRootLogin</code> 由 <code>yes</code> 改为 <code>no</code> , 并且去掉前面的注释符</li>
<li>修改 <code>Port</code> 由22 改为其他数值</li>
</ul>
<ol start="2">
<li>重启sshd服务<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/25.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/25.html" class="post-title-link" itemprop="url">Docker常用命令</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-11-13 17:19:00" itemprop="dateCreated datePublished" datetime="2017-11-13T17:19:00+08:00">2017-11-13</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DevOps/" itemprop="url" rel="index"><span itemprop="name">DevOps</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="images相关命令"><a href="#images相关命令" class="headerlink" title="images相关命令"></a>images相关命令</h2><h3 id="编译一个镜像"><a href="#编译一个镜像" class="headerlink" title="编译一个镜像"></a>编译一个镜像</h3><p>根据当前目录下的Dockerfile创建<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">docker build -t friendlyhello .</span><br></pre></td></tr></table></figure></p>
<h3 id="列出所有的镜像"><a href="#列出所有的镜像" class="headerlink" title="列出所有的镜像"></a>列出所有的镜像</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ docker images</span><br><span class="line">REPOSITORY               TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">friendlyhello            latest              2e202abc6a75        23 hours ago        148MB</span><br></pre></td></tr></table></figure>
<p>列出本机所有镜像<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image ls -a</span><br></pre></td></tr></table></figure></p>
<h3 id="启动镜像"><a href="#启动镜像" class="headerlink" title="启动镜像"></a>启动镜像</h3><p>启动镜像的同时映射本地4000到容器的80端口</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 4000:80 friendlyhello</span><br><span class="line"><span class="comment">#等价于</span></span><br><span class="line">docker run -p 4000:80 friendlyhello:latest</span><br><span class="line"><span class="comment">#以守护进程的方式启动该镜像</span></span><br><span class="line">docker run -d -p 4000:80 friendlyhello</span><br></pre></td></tr></table></figure>
<h3 id="拉取远端镜像仓库并执行"><a href="#拉取远端镜像仓库并执行" class="headerlink" title="拉取远端镜像仓库并执行"></a>拉取远端镜像仓库并执行</h3><p>如果镜像不在本地机器上，则从远端仓库中拉取到本地<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 4000:80 username/repository:tag</span><br></pre></td></tr></table></figure></p>
<p><strong>PS:如果没有指定tag，则默认tag为latest</strong></p>
<h3 id="给某个镜像打tag"><a href="#给某个镜像打tag" class="headerlink" title="给某个镜像打tag"></a>给某个镜像打tag</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag image  username/repository:tag</span><br></pre></td></tr></table></figure>
<p>例如：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ docker tag friendlyhello  mervyn1205/get-started:part3</span><br></pre></td></tr></table></figure></p>
<h3 id="发布镜像"><a href="#发布镜像" class="headerlink" title="发布镜像"></a>发布镜像</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push username/repository:tags</span><br></pre></td></tr></table></figure>
<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><p>删除指定镜像<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rm &lt;image id&gt;</span><br></pre></td></tr></table></figure></p>
<p>删除本机所有镜像<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rm $(docker image ls -a -q)</span><br></pre></td></tr></table></figure></p>
<h2 id="container相关命令"><a href="#container相关命令" class="headerlink" title="container相关命令"></a>container相关命令</h2><h3 id="列出正在运行的容器"><a href="#列出正在运行的容器" class="headerlink" title="列出正在运行的容器"></a>列出正在运行的容器</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker container ls</span><br><span class="line"><span class="comment"># 列出所有的容器，包括未执行的</span></span><br><span class="line">docker container ls -a</span><br></pre></td></tr></table></figure>
<h3 id="列出某个正在运行的容器的IP"><a href="#列出某个正在运行的容器的IP" class="headerlink" title="列出某个正在运行的容器的IP"></a>列出某个正在运行的容器的IP</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --format=<span class="string">"&#123;&#123; .NetworkSettings.IPAddress &#125;&#125;"</span> CONTAINER_ID</span><br><span class="line"></span><br><span class="line">docker inspect -f <span class="string">'&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;'</span> CONTAINER_ID</span><br></pre></td></tr></table></figure>
<h3 id="停止某个正在运行的容器"><a href="#停止某个正在运行的容器" class="headerlink" title="停止某个正在运行的容器"></a>停止某个正在运行的容器</h3><p>优雅的停止指定容器<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container stop CONTAINER_ID</span><br></pre></td></tr></table></figure></p>
<p>强制关闭指定容器<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container <span class="built_in">kill</span> &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p>从本地机器上删除指定容器<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container rm &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>删除所有容器<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container rm $(docker container ls -a -q)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/85.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/85.html" class="post-title-link" itemprop="url">Linux搭建 Supervisor 及 cesi 管理进程</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-08-09 15:45:00" itemprop="dateCreated datePublished" datetime="2017-08-09T15:45:00+08:00">2017-08-09</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DevOps/" itemprop="url" rel="index"><span itemprop="name">DevOps</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="supervisor安装"><a href="#supervisor安装" class="headerlink" title="supervisor安装"></a>supervisor安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br><span class="line"><span class="meta">#</span> easy_install supervisor</span><br></pre></td></tr></table></figure>
<p>supervisor安装完毕后，运行echo_supervisord_conf命令将内容重定向到<code>/etc/supervisord.conf</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">echo_supervisord_conf&gt;</span>/etc/supervisord.conf</span><br></pre></td></tr></table></figure></p>
<p><code>mkdir /etc/supervisor</code><br>修改 <code>/etc/supervisord.conf</code> 部分区块<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[include]</span></span><br><span class="line"><span class="attr">files</span> = /etc/supervisor/*.ini</span><br></pre></td></tr></table></figure></p>
<p>如果需要使用web访问控制supervisor，则修改 <code>/etc/supervisord.conf</code> 配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[inet_http_server]         ; inet (TCP) server disabled by default</span><br><span class="line">port=120.0.0.1:8001        ; ip_address:port specifier, *:port for all iface</span><br><span class="line">username=user              ; default is no username (open server)</span><br><span class="line">password=pass               ; default is no password (open server)</span><br></pre></td></tr></table></figure></p>
<p>启动 supervisor<br><code>supervisord -c /etc/supervisord.conf</code></p>
<h2 id="supervisord-管理"><a href="#supervisord-管理" class="headerlink" title="supervisord 管理"></a>supervisord 管理</h2><p>Supervisord 安装完成后有两个可用的命令行 <code>supervisord</code> 和 <code>supervisorctl</code>，命令使用解释如下：</p>
<p>supervisord，初始启动 Supervisord，启动、管理配置中设置的进程。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl stop programxxx   # 停止某一个进程(programxxx)</span><br><span class="line">supervisorctl start programxxx # 启动某个进程</span><br><span class="line">supervisorctl restart programxxx # 重启某个进程</span><br><span class="line">supervisorctl stop groupworker  # 重启所有属于名为 groupworker 这个分组的进程(start,restart 同理)</span><br><span class="line">supervisorctl stop all # 停止全部进程，注：start、restart、stop 都不会载入最新的配置文件。</span><br><span class="line">supervisorctl reload # 载入最新的配置文件，停止原有进程并按新的配置启动、管理所有进程。</span><br><span class="line">supervisorctl update # 根据最新的配置文件，启动新配置或有改动的进程，配置没有改动的进程不会受影响而重启。</span><br></pre></td></tr></table></figure>
<h2 id="cesi安装"><a href="#cesi安装" class="headerlink" title="cesi安装"></a>cesi安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Gamegos/cesi</span><br><span class="line">cd cesi &amp;&amp; mkdir pack</span><br><span class="line">python setup.py build</span><br><span class="line">python setup.py install</span><br><span class="line">sqlite3 userinfo.db &lt; userinfo.sql</span><br><span class="line">cp cesi.conf /etc/cesi.conf  ### 自行修改cesi.conf内容，kv对，很简单</span><br><span class="line">cd cesi &amp;&amp; python web.py     ### 即可启动成功</span><br></pre></td></tr></table></figure>
<p><strong>一切顺利的话，可通过页面 <a href="http://ip:5000，初始用户名，密码都是admin" target="_blank" rel="noopener">http://ip:5000，初始用户名，密码都是admin</a></strong></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/87.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/87.html" class="post-title-link" itemprop="url">使用 postman 接口测试并自动生成签名</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-16 15:47:00" itemprop="dateCreated datePublished" datetime="2017-07-16T15:47:00+08:00">2017-07-16</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Postman是chrome 的一款插件, 现在单独可以作为一个软件进行下载，主要用于做接口请求测试,无论是前端,后台还是测试人员,都可以用 <code>postman</code> 来测试接口,用起来非常方便。</p>
<p>在实际开发过程中，很多接口都会采用各种加密手段来保证接口的安全性。比如根据接口参数生成一个签名，在请求此接口的时候需要将此签名传递到后端。</p>
<p>在测试过程中，理想的情况是我们只需要变更提交的参数即可，而不是要我们每次调用接口时手动计算签名。而postman这款神器恰恰能满足我们的需求。</p>
<blockquote>
<p>在postman实际调用接口前，可以执行自定义js，从而实现数据签名</p>
</blockquote>
<blockquote>
<p>自定义JS可以获取到请求参数、链接参数，并且可以自定义变量</p>
</blockquote>
<p><strong>假设现在后端需要进行如下加密校验：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$appKey = <span class="string">"abcde"</span>;</span><br><span class="line">$requestBody = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$sign = md5($_GET[<span class="string">'app_id'</span>].$appKey.$_GET[<span class="string">'ver'</span>].$appKey . $requestBody);</span><br><span class="line"><span class="keyword">if</span> ($sign == $_GET[<span class="string">'sign'</span>]) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"校验通过"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"校验不通过"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们需要通过postman自动生成对应签名并在请求时传递到后端</p>
<h3 id="修改Pre-request-Script"><a href="#修改Pre-request-Script" class="headerlink" title="修改Pre-request Script"></a>修改Pre-request Script</h3><p>选择pre-request Script 输入如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var app_id = postman.getGlobalVariable(&quot;app_id&quot;);</span><br><span class="line">var ver = postman.getGlobalVariable(&quot;ver&quot;);</span><br><span class="line">var salt = postman.getGlobalVariable(&quot;app_key&quot;);</span><br><span class="line">var postBody = request.data</span><br><span class="line">var param = app_id + salt  + ver + postBody;</span><br><span class="line">var sign = CryptoJS.MD5(param, &#123;</span><br><span class="line">    asString: true</span><br><span class="line">  &#125;);</span><br><span class="line">postman.setGlobalVariable(&apos;sign&apos;,sign);</span><br></pre></td></tr></table></figure>
<p>在 url 上的参数有些不同，，， 默认去读取当前环境变量中相同的变量的值，如果当前环境变量中没有则去读取全局变量中对应的值。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/91.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/91.html" class="post-title-link" itemprop="url">判断 Composer 中加载的依赖包对应的版本号</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-02 15:51:00" itemprop="dateCreated datePublished" datetime="2017-07-02T15:51:00+08:00">2017-07-02</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>composer在引用各种依赖包时，通常需要定义依赖包的版本号，下面描述当使用不同引用方式时，对应各依赖包的版本号的含义。</p>
<p>composer.json中引用的各个包时实际对应的版本号的区别如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    "package":"1.2.1",    //依赖包的版本 =1.2.1</span><br><span class="line">    "package":"&gt;=1.2.1",  //依赖包的版本 &gt;=1.2.1</span><br><span class="line">    "package":"&lt;1.2.1",   //依赖包的版本 &lt;1.2.1</span><br><span class="line">    "package":"1.2.*",    //依赖包的版本 &gt;=1.2.0 &amp;&amp; &lt;1.3.0</span><br><span class="line">    "package":"~1.2.1",   //依赖包的版本 &gt;=1.2.1 &amp;&amp; &lt;1.3.0</span><br><span class="line">    "package":"~1.2",     //依赖包的版本 &gt;=1.2.0 &amp;&amp; &lt;2.0.0</span><br><span class="line">    "package":"^1.2.1",   //依赖包的版本 &gt;=1.2.1 &amp;&amp; &lt;2.0.0</span><br><span class="line">    "package":"^0.3.2",   //依赖包的版本 &gt;=0.3.2 &amp;&amp; &lt;0.4.0</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/93.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/93.html" class="post-title-link" itemprop="url">Redis 常用操作</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-06-27 15:51:00" itemprop="dateCreated datePublished" datetime="2017-06-27T15:51:00+08:00">2017-06-27</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NoSQL/" itemprop="url" rel="index"><span itemprop="name">NoSQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Key的相关命令"><a href="#Key的相关命令" class="headerlink" title="Key的相关命令"></a>Key的相关命令</h2><p>Redis是key-value数据库。key使用字符串存储，但是key中不能出现空格或者换行符“\n”(仅限于key)。尽量使用较短的key<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exists key</span><br></pre></td></tr></table></figure></p>
<p>测试指定key是否存在，返回1表示存在，返回0表示不存在</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">del key1 key2 ...keyN</span><br></pre></td></tr></table></figure>
<p>删除指定key，返回删除key的数目，返回0表示给定key都不存在</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> key</span><br></pre></td></tr></table></figure>
<p>返回给定key的value类型。返回none表示不存在key，String为字符类型，List为链表类型…</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keys pattern</span><br></pre></td></tr></table></figure>
<p>返回匹配指定模式的所有key</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expire key seconds</span><br></pre></td></tr></table></figure>
<p>设置给定key的过期时间</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">randomkey</span><br></pre></td></tr></table></figure>
<p>返回从当前数据库中随机选择的一个key，如果当前数据库是空的，返回空串</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename oldkey newkey</span><br></pre></td></tr></table></figure>
<p>重命名key，如果newkey存在，将被覆盖，返回1表示成功，返回0表示失败。若失败，则可能是oldkey不存在或者newkey相同</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">renamenx oldkey newkey</span><br></pre></td></tr></table></figure>
<p>同上，如果newkey存在返回失败<br>ttl key 返回设置过期时间key的剩余秒数， -1表示key不存在或者没有设置过期时间<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move key db-index</span><br></pre></td></tr></table></figure></p>
<p>将key从当前数据库移动到指定数据库。返回1成功，返回0表示key不存在或者已经在指定数据库中</p>
<h2 id="Redis数据类型"><a href="#Redis数据类型" class="headerlink" title="Redis数据类型"></a>Redis数据类型</h2><p>Redis支持的数据类型：String、List、Set、Sorted Set、Hash等。</p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><h4 id="String类型支持的命令"><a href="#String类型支持的命令" class="headerlink" title="String类型支持的命令"></a>String类型支持的命令</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> key value</span><br></pre></td></tr></table></figure>
<p>设置key对应String类型的值，返回1表示成功，返回0表示失败</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setnx key value</span><br></pre></td></tr></table></figure>
<p>如果key不存在，设置key对应String类型的值。如果key已经存在，返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get key</span><br></pre></td></tr></table></figure>
<p>获取key对应的String值，如果key不存在返回nil</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getset key value</span><br></pre></td></tr></table></figure>
<p>先获取key的值，再设置key的值，如果key不存在返回nil</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mget key1 key2 ... keyN</span><br></pre></td></tr></table></figure>
<p>一次获取多个key的值，如果对应key不存在，则对应返回nil</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mset key1 value1 ... keyN valueN</span><br></pre></td></tr></table></figure>
<p>一次设置多个key的值，成功返回1，表示所有的值都设置；失败返回0，表示没有任何值被设置</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msetnx key1 value1 ... keyN valueN</span><br></pre></td></tr></table></figure>
<p>一次设置多个key的值，但不会覆盖已经存在的key</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incr key</span><br></pre></td></tr></table></figure>
<p>向key对应的值加1，并返回新的值。注意incr一个不是int的value会返回错误<br>incr一个不存在的key，则设置key值为1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decr key</span><br></pre></td></tr></table></figure>
<p>向key对应的值做减1，decr一个不存在的key，则设置key值为-1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incrby key <span class="built_in">integer</span></span><br></pre></td></tr></table></figure>
<p>向key对应的值加上一个指定整数integer，key不存在时会设置key，并认为原来的value是0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decrby key <span class="built_in">integer</span></span><br></pre></td></tr></table></figure>
<p>向key对应的值减去一个指定整数integer。decrby完全是为了可读性，通过incrby一个负值实现同样效果，反之一样 可以用String类型缓存一些静态文件，如图片文件、CSS文件等。同时String支持incr操作，可以用作统计计算，如统计网站访问次数、博客访问次数等。</p>
<p>例：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; <span class="built_in">set</span> s1 v1        //设置s1的值为 v1，类似MySQL的replace操作</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; get s1           //获取s1的值</span><br><span class="line"><span class="string">"v1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; setnx s1 vv1     //设置s1的值为vv1，s1如果存在不更新</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; get s1</span><br><span class="line"><span class="string">"v1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; <span class="built_in">set</span> s1 vvv1</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; get s1</span><br><span class="line"><span class="string">"vvv1"</span></span><br><span class="line">//获取key（s1）的值，并重新设置s1的值为v1。返回重新设置前的key的值，如果key不存在则返回(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; getset s1 v1</span><br><span class="line"><span class="string">"vvv1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; get s1</span><br><span class="line"><span class="string">"v1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; getset s6 s6</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; get s6</span><br><span class="line"><span class="string">"s6"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; <span class="built_in">set</span> s2 v2</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; <span class="built_in">set</span> s3 v3</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; mget s1 s7 s2 s3    //获取s1、s2、s3的值,如果某个key不存在则返回(nil)</span><br><span class="line">1) <span class="string">"v1"</span></span><br><span class="line">2) (nil)</span><br><span class="line">3) <span class="string">"v2"</span></span><br><span class="line">3) <span class="string">"v3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; mset s1 vv1 s4 v4   //同时设置s1、s4的值,设置值类似replace操作</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; mget s1 s2 s3</span><br><span class="line">1) <span class="string">"vv1"</span>  //设置之前是 <span class="string">"v1"</span></span><br><span class="line">2) <span class="string">"v2"</span></span><br><span class="line">3) <span class="string">"v3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; incr s1            //key对应的value的类型必须为<span class="built_in">integer</span>，否则报错</span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">redis 127.0.0.1:6379&gt; incr s5</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; get s5</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; incr s5            //对s5加1，返回新的s5的值</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; get s5</span><br><span class="line"><span class="string">"2"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; decr s1            //key对应的value的类型必须为<span class="built_in">integer</span>，否则报错</span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">redis 127.0.0.1:6379&gt; decr s5            //对s5减1，返回新的s5的值</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; get s5</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; incrby s5 2        //对s5加2，返回新的s5的值</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; get s5</span><br><span class="line"><span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; incrby s1 2</span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">redis 127.0.0.1:6379&gt; decrby s5 -2       //对s5减-2，返回新的s5的值</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">redis 127.0.0.1:6379&gt; get s5</span><br><span class="line"><span class="string">"5"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="List类型"><a href="#List类型" class="headerlink" title="List类型"></a>List类型</h3><p><code>List数据类型指key对应的是一个双向链表结构</code></p>
<h4 id="List类型支持的命令"><a href="#List类型支持的命令" class="headerlink" title="List类型支持的命令"></a>List类型支持的命令</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpush key string</span><br></pre></td></tr></table></figure>
<p>向key对应List头部添加一个字符串元素，成功返回1，失败返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpush key string</span><br></pre></td></tr></table></figure>
<p>向key对应List尾部添加一个字符串元素，成功返回1，失败返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llen key</span><br></pre></td></tr></table></figure>
<p>返回key对应List的长度，如果key不存在返回0，如果key对应类型不是List返回错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrange key start end</span><br></pre></td></tr></table></figure></p>
<p>返回指定区间内（start~end）的元素，下标从0开始，负值表示从链表尾部开始计算，-1表示倒数第一个元素，<br>key不存在返回空列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ltrim key start end</span><br></pre></td></tr></table></figure></p>
<p>截取List指定区间（start~end）元素，成功返回1，key或者下标不存在返回错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lset key index value</span><br></pre></td></tr></table></figure></p>
<p>设置List中指定下标的元素值，成功返回1，key或者下标不存在返回错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrem key count value</span><br></pre></td></tr></table></figure></p>
<p>从List头部（count正数）或尾部（count负数）删除一定数量（count绝对值）的匹配value的元素，返回删除的元素数量。<br>count为0时删除全部<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpop key</span><br></pre></td></tr></table></figure></p>
<p>从List头部删除并返回删除元素。如果key对应List不存在或者是空返回nil，如果key对应值不是List返回错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpop key</span><br></pre></td></tr></table></figure></p>
<p>从List尾部删除并返回删除元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blpop key1...keyN timeout</span><br></pre></td></tr></table></figure></p>
<p>从左到右扫描key1…keyN，对第一个非空List进行lpop操作并返回。如果所有List都是空或不存在，阻塞timeout秒，<br>timeout为0表示一直阻塞。阻塞时，如果有其他client对key1…keyN中任意一个key进行push操作，阻塞解除并返回。<br>如果超时发生，则返回nil<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brpop key1...keyN timeout</span><br></pre></td></tr></table></figure></p>
<p>功能与blpop相似，不同的是blpop从头部删除，而brpop从尾部删除<br>可以用List类型存放微博中的”我关注的列表“，或者论坛中所有回帖ID。使用List还可以实现消息队列功能，减轻数据库的压力。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush list1 1     //从list1头部插入一个元素，value为1,返回list1的长度</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush list1 2     //从list1头部插入一个元素，value为2,返回list1的长度，此时list1为： [2] [1]</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; llen list1        //返回list1的长度</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1  //返回list1 从头到尾所有的元素</span><br><span class="line">1) <span class="string">"2"</span></span><br><span class="line">2) <span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 3      //从list1尾部插入一个元素，value为3, 返回list1的长度,此时list1为： [2] [1] [3]</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"2"</span></span><br><span class="line">2) <span class="string">"1"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 1 6   //列出list1的元素，从下标为1开始，到下标为6结束</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 4      //从list1尾部插入一个元素，value为4</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 5      //从list1尾部插入一个元素，value为5</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 6      //从list1尾部插入一个元素，value为6，此时list1为： [2] [1] [3] [4] [5] [6]</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">redis 127.0.0.1:6379&gt; ltrim list1 0 1   //截取list1的元素，只保留下标0~1的元素,此时list1为： [2] [1]</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"2"</span></span><br><span class="line">2) <span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 3</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 4</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">redis 127.0.0.1:6379&gt; rpush list1 5     //此时list1为： [2] [1] [3] [4] [5]</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">redis 127.0.0.1:6379&gt; lset list1 0 22   //设置List1中下标为0的值为22，此时list1为：[22] [1] [3] [4] [5]</span><br><span class="line">redis 127.0.0.1:6379&gt; lset ss 0 1       //设置ss中下标为0的值为1,因为key(22)不存在，报错</span><br><span class="line">(error) ERR no such key</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"1"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">4) <span class="string">"4"</span></span><br><span class="line">5) <span class="string">"5"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lset list1 5 6    //设置ss中下标为0的值为1,因为key(list1)的下标 5 不存在，报错</span><br><span class="line">(error) ERR index out of range</span><br></pre></td></tr></table></figure></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">例2：</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1  //从头到尾列出list1的所有元素</span><br><span class="line"> 1) <span class="string">"22"</span></span><br><span class="line"> 2) <span class="string">"1"</span></span><br><span class="line"> 3) <span class="string">"3"</span></span><br><span class="line"> 4) <span class="string">"4"</span></span><br><span class="line"> 5) <span class="string">"55"</span></span><br><span class="line"> 6) <span class="string">"3"</span></span><br><span class="line"> 7) <span class="string">"3"</span></span><br><span class="line"> 8) <span class="string">"3"</span></span><br><span class="line"> 9) <span class="string">"22"</span></span><br><span class="line">10) <span class="string">"3"</span></span><br><span class="line">11) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrem list1 0 1     //删除list1中所有值为1的元素，此时list1为：[22] [3] [4] [55] [3] [3] [3] [22] [22] [3] [4]</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lrem list1 -1 3   //从尾部开始删除list1中的1个值为3的元素，返回删除元素的数量</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">3) <span class="string">"4"</span></span><br><span class="line">4) <span class="string">"55"</span></span><br><span class="line">5) <span class="string">"3"</span></span><br><span class="line">6) <span class="string">"3"</span></span><br><span class="line">7) <span class="string">"3"</span></span><br><span class="line">8) <span class="string">"22"</span></span><br><span class="line">9) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrem list1 1 3    //从头部开始删除list1中的1个值为3的元素，返回删除元素的数量</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"4"</span></span><br><span class="line">3) <span class="string">"55"</span></span><br><span class="line">4) <span class="string">"3"</span></span><br><span class="line">5) <span class="string">"3"</span></span><br><span class="line">6) <span class="string">"3"</span></span><br><span class="line">7) <span class="string">"22"</span></span><br><span class="line">8) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lpop list1    //从list1头部删除一个元素，并返回该元素的value值，此时list1为：[4] [55] [3] [3] [3] [22] [4]</span><br><span class="line"><span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; rpop list1    //从list1尾部删除一个元素，并返回该元素的值</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; rpop list1    //从list1尾部删除一个元素，并返回该元素的值，此时list1为：[4] [55] [3] [3] [3]</span><br><span class="line"><span class="string">"22"</span></span><br><span class="line"></span><br><span class="line">client1 &gt;&gt; redis 127.0.0.1:6379&gt; blpop list f1 f2 0  //从左到右扫描f1、f2，返回对第一个非空List进行lpop操作并返回。因为f1、f2都不存在,所以一直阻塞。</span><br><span class="line">client2 &gt;&gt; redis 127.0.0.1:6379&gt; lpush f1 1          //此时有一个客户端push进了一个元素</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">client1 &gt;&gt; redis 127.0.0.1:6379&gt; blpop list f1 f2 0  //该阻塞的进程结束阻塞，并进行lpop操作</span><br><span class="line">1) <span class="string">"l1"</span></span><br><span class="line">2) <span class="string">"1"</span></span><br><span class="line">(40.47s)</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"4"</span></span><br><span class="line">2) <span class="string">"55"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">4) <span class="string">"3"</span></span><br><span class="line">5) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lpush list2 1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush list2 2</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush list2 3         //此时list2为： [3] [2] [1]</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; blpop list1 list2 0  //从左到右扫描list1、list2，对第一个非空List进行lpop操作并返回。即删除并返回list1的第一个元素</span><br><span class="line">1) <span class="string">"list1"</span></span><br><span class="line">2) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"55"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">4) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; brpop list1 list2 0  //从左到右依次扫描list1、list2,对第一个非空List进行rpop操作。即删除并返回list1的最后一个元素</span><br><span class="line">1) <span class="string">"list1"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"55"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list2 0 -1</span><br><span class="line">1) <span class="string">"3"</span></span><br><span class="line">2) <span class="string">"2"</span></span><br><span class="line">3) <span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"55"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; ltrim list1 3 6   //截取并保留list1的下标（3~6）的部分值</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line"></span><br><span class="line">例3：</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line"> 1) <span class="string">"22"</span></span><br><span class="line"> 2) <span class="string">"3"</span></span><br><span class="line"> 3) <span class="string">"4"</span></span><br><span class="line"> 4) <span class="string">"5"</span></span><br><span class="line"> 5) <span class="string">"3"</span></span><br><span class="line"> 6) <span class="string">"3"</span></span><br><span class="line"> 7) <span class="string">"3"</span></span><br><span class="line"> 8) <span class="string">"22"</span></span><br><span class="line"> 9) <span class="string">"3"</span></span><br><span class="line">10) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; lrem list1 -2 3   //从尾部开始删除list1中的2个值为3的元素，返回删除元素的数量</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange list1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"3"</span></span><br><span class="line">3) <span class="string">"4"</span></span><br><span class="line">4) <span class="string">"5"</span></span><br><span class="line">5) <span class="string">"3"</span></span><br><span class="line">6) <span class="string">"3"</span></span><br><span class="line">7) <span class="string">"22"</span></span><br><span class="line">8) <span class="string">"4"</span></span><br></pre></td></tr></table></figure>
<h3 id="Set类型"><a href="#Set类型" class="headerlink" title="Set类型"></a>Set类型</h3><p><code>Set数据类型的优点是快速查找元素是否存在，用于记录一些不能重复的数据。例如，在网站注册账号时用户名不能重复，使用Set记录注册用户，如果注册的用户名已经存在于Set中，则拒绝此用户登录。</code></p>
<p>####Set类型支持的命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sadd key number</span><br></pre></td></tr></table></figure>
<p>添加一个String元素到key对应的set集合中，成功返回1，如果元素在集合中返回0，<br>key对应的Set不存在返回错误</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srem key number</span><br></pre></td></tr></table></figure>
<p>从key对应set中移除给定元素，成功返回1，如果member在集合中不存在或者key不存在返回0，<br>如果key对应的不是set类型的值返回错误<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spop key</span><br></pre></td></tr></table></figure></p>
<p>删除并返回key对应set中随机的一个元素，如果set是空或者key对应的set不存在返回nil</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srandmember key</span><br></pre></td></tr></table></figure>
<p>同spop，随机取set中的一个元素，但是不删除元素</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smove srckey dstkey member</span><br></pre></td></tr></table></figure>
<p>从srckey对应set中移除member并添加到dstkey对应set中，整个操作是原子的。成功返回1，如果member在<br>srckey总不存在返回0，如果key对应的值不是set类型，返回错误</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scard key</span><br></pre></td></tr></table></figure>
<p>返回set的元素个数，如果set是空或者key不存在返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sismember key member</span><br></pre></td></tr></table></figure>
<p>判断member是否在set中，存在返回1，不存在或者key对应的set集合不存在返回0<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sinter key1 key2...keyN</span><br></pre></td></tr></table></figure></p>
<p>返回所有给定key的交集</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sinterstore dstkey key1 key2...keyN</span><br></pre></td></tr></table></figure>
<p>同sinter，同时将交集存到dstkey对应set集合中</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sunion key1 key2...keyN</span><br></pre></td></tr></table></figure>
<p>返回所有给定key的并集</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sunionstore dstkey key1 key2 ...keyN</span><br></pre></td></tr></table></figure>
<p>同sunion，同时把并集保存到dstkey对应的set集合中</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdiff key1 key2...keyN</span><br></pre></td></tr></table></figure>
<p>返回所有给定key的差集</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdiffstore dstkey key1 key2...keyN</span><br></pre></td></tr></table></figure>
<p>同sdiff，同时把差集保存到dstkey对应的set集合中</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smembers key</span><br></pre></td></tr></table></figure>
<p>返回key对应set的所有元素，结果是无序的</p>
<p>Set类型通常用于记录做过某些事情。例如在某些投票系统中，每个用户一天只能投票一次那么可以使用Set来记录某个用户的投票情况，只需要以日期作为Set的key，则将用户ID作为number即可。要查看某一个用户今天是否投过票，只需以今天的日期作为key去查询此用户ID是否存在。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 1     //向集合set1中添加一个元素，值为1。类似MySQL的Insert操作</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 2</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 1     //向集合set1中添加一个元素，值为1。因为1已经在集合set1中，所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 3</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 4</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set1   //返回set1集合中的所有元素</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"2"</span></span><br><span class="line">3) <span class="string">"3"</span></span><br><span class="line">4) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; srandmember set1  //随机返回set1集合中的一个元素</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; srandmember set1</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; srem set1 ss   //移除set1集合中的元素ss，因为该元素不存在所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; srem set3 ss   //移除set1集合中的元素ss，因为该key（set3）不存在所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; srem set1 3    //移除set1集合中的元素3，返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; spop set1      //删除并返回set1对应集合中随机的一个元素，如果<span class="built_in">set</span>是空或者key对应的<span class="built_in">set</span>不存在返回nil</span><br><span class="line"><span class="string">"2"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; spop set1</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; spop set1</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; spop set1</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; spop set4</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 4</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set1</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"2"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; smove set1 set2 1   //从set1移除值为1的元素并添加到set2中，返回1。</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; smove set3 set2 1   //从set1移除值为1的元素并添加到set2中，因为set3不存在所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; smove set1 set2 1   //从set1移除值为1的元素并添加到set2中，因为set1中不存在值为1的元素，所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"2"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set1</span><br><span class="line">1) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; scard set2           //返回set2集合的元素个数</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; scard set3           //返回set2集合的元素个数，set3不存在，所以返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set1</span><br><span class="line">1) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sismember set1 2     //判断值为2的元素是否在集合set1中，不存在返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; sismember set1 4     //判断值为4的元素 是否在<span class="built_in">set</span>中，存在返回1，存在返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sinter set1 set2     //返回所有给定key的交集</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd set1 1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sinter set1 set2     //返回所有给定key的交集</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set3</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">redis 127.0.0.1:6379&gt; sinterstore set3 set1 set2  //返回所有给定key（set1、set2）的交集,并将结果添加到set3中，覆盖添加</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set3</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sunion set1          //返回所有给定key的并集</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sunion set1 set2     //返回所有给定key的并集</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"2"</span></span><br><span class="line">3) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sunionstore set3 set1 set2   //返回所有给定key的并集,并将结果添加到set3中，覆盖添加</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set3</span><br><span class="line">1) <span class="string">"1"</span></span><br><span class="line">2) <span class="string">"2"</span></span><br><span class="line">3) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sdiff set1 set2      //返回所有给定key的差集</span><br><span class="line">1) <span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; sdiffstore set3 set1 set2    //返回所有给定key的差集,并将结果添加到set3中，覆盖添加</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers set3</span><br><span class="line">1) <span class="string">"4"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Sorted-Set类型"><a href="#Sorted-Set类型" class="headerlink" title="Sorted Set类型"></a>Sorted Set类型</h3><p>Sorted Set类型与Set类型相似，都是String类型元素的集合，不同的是Sorted Set属于有序集合，而Sorted Set通过一个double类型的整数score进行排序。<br>Set能做的事Sorte Set也可以做。而Sorted Set还可以完成一些Set不能做的事情，如使用Sorted Set构建一个具有优先级的队列，这也是List类型不能实现的。</p>
<h4 id="Sorted-Set类型支持的命令"><a href="#Sorted-Set类型支持的命令" class="headerlink" title="Sorted Set类型支持的命令"></a>Sorted Set类型支持的命令</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zadd key score member</span><br></pre></td></tr></table></figure>
<p>添加元素member到集合，元素在集合中存在则更新对应score</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrem key member</span><br></pre></td></tr></table></figure>
<p>删除指定元素，1表示成功，如果元素不存在则返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zincrby key incr member</span><br></pre></td></tr></table></figure>
<p>增加对应member的score值，并且重新排序，返回更新后的score</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrank key member</span><br></pre></td></tr></table></figure>
<p>返回指定元素在集合中的排名（下标），集合中元素按score从小到大排序的</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrevrank key member</span><br></pre></td></tr></table></figure>
<p>同上，但是集合中元素按score从大到小排序</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrange key start end</span><br></pre></td></tr></table></figure>
<p>从集合中指定区间的元素，返回结果按score顺序排列</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrevrange key start end</span><br></pre></td></tr></table></figure>
<p>同上，返回结果按score逆序排列</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrangebyscore key min max</span><br></pre></td></tr></table></figure>
<p>返回集合中score在给定区间的元素</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zcount key min max</span><br></pre></td></tr></table></figure>
<p>返回集合中score在给定区间的数量<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zcard key</span><br></pre></td></tr></table></figure></p>
<p>返回集合中元素的个数<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zscore key element</span><br></pre></td></tr></table></figure></p>
<p>返回给定元素对应的score<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zremrangebyrank key min max</span><br></pre></td></tr></table></figure></p>
<p>删除集合中排名在给定区间的元素<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zremrangebyscore key min max</span><br></pre></td></tr></table></figure></p>
<p>删除集合中score在给定区间的元素</p>
<p>Sorted Set类型在Web应用中非常有用。如排行榜应用中按”顶贴“次数排序，方法是：将排序的值设置成Sorted Set的score值，将具体数据设置成相应的value，用户每次按”顶贴“按钮时，只需执行zadd命令修改score值。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 11    //添加元素11到集合ss1，按score指定下标</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 22</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 11    //添加元素11到集合ss1，因为11已存在所以只是更新11的score值</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"11"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrem ss1 11       //删除ss1中值为11的元素</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1   //返回ss1 从头到尾所有的元素，按照score排列</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrange ss1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 11</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrange ss1 0 -1  //返回ss1 从头到尾所有的元素，按照score逆序排列</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"11"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrank ss1 11        //返回值为11的元素在Sorted Set中的下标，集合中元素按score从小到大排序的</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; zrank ss1 2         //返回值为2的元素在Sorted Set中的下标，不存在返回(nil)</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; zrank ss1 22        //返回值为22的元素在Sorted Set中的下标</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zincrby ss1 1 11    //增加值为11的元素的score值，并且重新排序，返回更新后的score，此时值为11的元素的score为2</span><br><span class="line"><span class="string">"2"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zincrby ss1 2 11</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1     //返回ss1 从头到尾所有的元素，按照score排列</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"11"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrange ss1 0 -1  //返回ss1从头到尾所有的元素，按照score逆序排列</span><br><span class="line">1) <span class="string">"11"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrank ss1 11     //返回值为11的元素在Sorted Set中的下标，集合中元素按score从大到小排序的</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrank ss1 22</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"11"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrange ss1 0 -1</span><br><span class="line">1) <span class="string">"11"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrank ss1 11</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrevrank ss1 11</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; zrangebyscore ss1 0 0   //返回集合中score在给定区间的元素,即列出ss1中score值在0 ~ 0之间的元素</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">redis 127.0.0.1:6379&gt; zrangebyscore ss1 0 1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrangebyscore ss1 1 1</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrangebyscore ss1 1 4  //返回集合中score在给定区间的元素,即列出ss1中score值在 1 ~ 4 之间的元素</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">2) <span class="string">"11"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrangebyscore ss1 1 3</span><br><span class="line">1) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zcount ss1 0 0         //返回集合中score在给定区间的数量，即列出ss1中元素score值0 ~ 0之间的元素的数量</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; zcount ss1 0 1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zcount ss1 0 2</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zcount ss1 0 4</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zcard ss1              //返回集合ss1中元素的个数</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zscore ss1 11          //返回给定元素11对应的score</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zscore ss1 2           //返回给定元素2对应的score，不存在则返回(nil)</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; zscore ss1 22</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zremrangebyrank ss1 0 1  //删除集合中排名在给定区间的元素,即删除ss1中下标为0~1之间的元素，返回删除的个数</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 11</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 2 33</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 4 22</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 3 44</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"11"</span></span><br><span class="line">2) <span class="string">"33"</span></span><br><span class="line">3) <span class="string">"44"</span></span><br><span class="line">4) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zremrangebyrank ss1 0 1   //删除集合中排名在给定区间的元素,即删除ss1中下标为0~1之间的元素，返回删除的个数</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"44"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 2 55</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 1 66</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"66"</span></span><br><span class="line">2) <span class="string">"55"</span></span><br><span class="line">3) <span class="string">"44"</span></span><br><span class="line">4) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zremrangebyrank ss1 1 2</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"66"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zscore ss1 66</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zscore ss1 22</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"66"</span></span><br><span class="line">2) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 2 77</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd ss1 3 88</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"66"</span></span><br><span class="line">2) <span class="string">"77"</span></span><br><span class="line">3) <span class="string">"88"</span></span><br><span class="line">4) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zremrangebyscore ss1 0 1  //删除ss1中元素score值在0~1之间的元素的数量，返回删除元素的个数</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"77"</span></span><br><span class="line">2) <span class="string">"88"</span></span><br><span class="line">3) <span class="string">"22"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; zremrangebyscore ss1 1 3  //删除集合中score在给定区间的元素,即删除ss1中元素score值在1~3之间的元素的数量</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; zrange ss1 0 -1</span><br><span class="line">1) <span class="string">"22"</span></span><br></pre></td></tr></table></figure>
<h3 id="Hash类型"><a href="#Hash类型" class="headerlink" title="Hash类型"></a>Hash类型</h3><p>Hash类型适合应用于存储对象，例如用户信息对象。把用户ID做为key，可把用户保存到Hash类型中。</p>
<h4 id="Hash类型支持的命令"><a href="#Hash类型支持的命令" class="headerlink" title="Hash类型支持的命令"></a>Hash类型支持的命令</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hset key field value</span><br></pre></td></tr></table></figure>
<p>设置key对应的Hash对象中指定域的值。如果key对应的Hash对象不存在，将创建此Hash对象。<br>如果指定的域已经存在，其值将被重置<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hget key field</span><br></pre></td></tr></table></figure></p>
<p>返回与field域关联的值，如果该域不存在或者key对应的Hash对象不存在，返回值nil<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hmget key field1...fieldN</span><br></pre></td></tr></table></figure></p>
<p>返回存储在key对应的Hash对象中各个指定域相关关联的值。对于在Hash对象中不存在的域，返回值为nil<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hmset key field1 value1 ... fieldN valueN</span><br></pre></td></tr></table></figure></p>
<p>设置存储在key对应的Hash对象中指定域的值。该命令会复写Hash已经存在的域。如果key对应的Hash对象<br>不存在，将创建此对象<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hincrby key field <span class="built_in">integer</span></span><br></pre></td></tr></table></figure></p>
<p>将存储在key对应的Hash对象中field域相关联的值加上由integer指定的值。如果key对应的Hash对象不存在，<br>则创建此Hash对象。如果field域不存在或者具有一个不能表示为整型的字符串值，在执行该操作前设置为0<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexists key field</span><br></pre></td></tr></table></figure></p>
<p>查看指定field域是否已经存在<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdel key field</span><br></pre></td></tr></table></figure></p>
<p>删除指定的field域，返回1。如果指定的域或者key不存在，返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hlen key</span><br></pre></td></tr></table></figure>
<p>返回key对应的Hash对象中field数，如果key不存在，返回0</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hkeys key</span><br></pre></td></tr></table></figure>
<p>返回key对应的Hash对象中所有field名称</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hvals key</span><br></pre></td></tr></table></figure>
<p>返回key对应的Hash对象中所有值</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgetall key</span><br></pre></td></tr></table></figure>
<p>返回key对应的Hash对象中所有域和相关联的值。在返回值中，每个域名称后面跟着相关联的值<br>例：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; hset h1 name tang   //设置h1的“name”域的值为“tang”，返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; hset h1 age 24      //设置h1的“age”域的值为“24”，返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; hset h1 sex male    //设置h1的“sex”域的值为“male”，返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; hget h1 name        //返回h1的“name”域的值</span><br><span class="line"><span class="string">"tang"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hget h1 age</span><br><span class="line"><span class="string">"24"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hset h1 name tie    //设置h1的“name”域的值为“tie”，因为h1的“name”域已经存在，所以其值被重新复制，并返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; hget h1 name</span><br><span class="line"><span class="string">"tie"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hmget h1 name age sex  //返回h1的“name”、“age”、“sex”域的值</span><br><span class="line">1) <span class="string">"tie"</span></span><br><span class="line">2) <span class="string">"24"</span></span><br><span class="line">3) <span class="string">"male"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hmset h2 name tang age 24 sex male  //设置h2的“name”、“age”、“sex”域的值，分别为“tang”、“24”、“male”</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; hmget h2 name age sex</span><br><span class="line">1) <span class="string">"tang"</span></span><br><span class="line">2) <span class="string">"24"</span></span><br><span class="line">3) <span class="string">"male"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hincrby h1 age 2       //将存储在h1对应的Hash对象中“age”域相关联的值加上2，返回新的“age”域的值</span><br><span class="line">(<span class="built_in">integer</span>) 26</span><br><span class="line">redis 127.0.0.1:6379&gt; hincrby h1 name 2</span><br><span class="line">(error) ERR <span class="built_in">hash</span> value is not an <span class="built_in">integer</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hget h1 age</span><br><span class="line"><span class="string">"26"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hexists h1 age      //查看存储在h1对应的Hash对象中指定的<span class="string">"age"</span>域是否已经存在</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; hexists h3 age      //查看存储在h3对应的Hash对象中指定的<span class="string">"age"</span>域是否已经存在，h3不存在，返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; hexists h1 age1     //查看存储在h1对应的Hash对象中指定的<span class="string">"age1"</span>域是否已经存在，age1不存在，返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; hdel h1 age         //删除h1中指定的<span class="string">"age"</span>域，返回1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; hdel h1 age         //删除h1中指定的<span class="string">"age"</span>域，age域不存在，返回0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; hget h1 age</span><br><span class="line">(nil)</span><br><span class="line">redis 127.0.0.1:6379&gt; hlen h1             //返回h1对应的Hash对象中field数</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; hkeys h1            //返回h1对应的Hash对象中所有field名称</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"sex"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hvals h1            //返回h1对应的Hash对象中所有值</span><br><span class="line">2) <span class="string">"male"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; hgetall h1          //返回h1对应的Hash对象中所有域和相关联的值.一个域、一个值的返回，即“name”为域，“tie”为值</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"tie"</span></span><br><span class="line">3) <span class="string">"sex"</span></span><br><span class="line">4) <span class="string">"male"</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mervyn">
      <meta itemprop="description" content="Coding Change Our Life">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mervyn's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/8.html" class="post-title-link" itemprop="url">Mysql数据库备份和还原常用的命令</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-06-25 12:16:00" itemprop="dateCreated datePublished" datetime="2017-06-25T12:16:00+08:00">2017-06-25</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据库备份"><a href="#数据库备份" class="headerlink" title="数据库备份"></a>数据库备份</h2><p><strong>备份MySQL数据库的命令</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename &gt; backupfile.sql</span><br></pre></td></tr></table></figure></p>
<p><strong>备份mysql数据库为带删除表的格式</strong></p>
<p><code>备份MySQL数据库为带删除表的格式，能够让该备份覆盖已有数据库而不需要手动删除原有数据库。</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -–add-drop-table -uusername -ppassword databasename &gt; backupfile.sql</span><br></pre></td></tr></table></figure></p>
<p><strong>直接将MySQL数据库压缩备份</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename | gzip &gt; backupfile.sql.gz</span><br></pre></td></tr></table></figure></p>
<p><strong>备份MySQL数据库某个(些)表</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword databasename specific_table1 specific_table2 &gt; backupfile.sql</span><br></pre></td></tr></table></figure></p>
<p><strong>同时备份多个MySQL数据库</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -hhostname -uusername -ppassword –databases databasename1 databasename2 databasename3 &gt; multibackupfile.sql</span><br></pre></td></tr></table></figure></p>
<p><strong>备份服务器上所有数据库</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump –all-databases &gt; allbackupfile.sql</span><br></pre></td></tr></table></figure></p>
<h2 id="数据库还原"><a href="#数据库还原" class="headerlink" title="数据库还原"></a>数据库还原</h2><p><strong>还原MySQL数据库的命令</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -hhostname -uusername -ppassword databasename &lt; backupfile.sql</span><br></pre></td></tr></table></figure></p>
<p><strong>还原压缩的MySQL数据库</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip &lt; backupfile.sql.gz | mysql -uusername -ppassword databasename</span><br></pre></td></tr></table></figure></p>
<p><strong>将数据库转移到新服务器</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uusername -ppassword databasename | mysql –host=*.*.*.* -C databasename</span><br></pre></td></tr></table></figure></p>
<p><strong>导出</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from tablename INTO OUTFILE '/tmp/xxx.txt' fields terminated by "," optionally enclosed by '"';</span><br></pre></td></tr></table></figure></p>
<p><strong>导入</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span> load data infile  '/tmp/xxx.txt' into table tablename fields terminated by ',' enclosed by '"';</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpeg" alt="Mervyn">
            
              <p class="site-author-name" itemprop="name">Mervyn</p>
              <div class="site-description motion-element" itemprop="description">Coding Change Our Life</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">57</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">37</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Mervyn1205" title="GitHub &rarr; https://github.com/Mervyn1205" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:ttz5127@163.com" title="E-Mail &rarr; mailto:ttz5127@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.mervyntang.com" title="https://www.mervyntang.com" rel="noopener" target="_blank">Mervyn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mervyn1205.github.io/linux-command" title="https://mervyn1205.github.io/linux-command" rel="noopener" target="_blank">Linux 命令查找</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">  <a href="http://www.miitbeian.gov.cn" rel="noopener" target="_blank">粤ICP备17078907号 </a>&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mervyn</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
